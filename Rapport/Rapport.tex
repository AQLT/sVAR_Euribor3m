% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames*,x11names*}{xcolor}
%
\documentclass[
  11pt,
]{article}
\usepackage{lmodern}
\usepackage{amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
  \usepackage{amssymb}
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  colorlinks=true,
  linkcolor=Maroon,
  filecolor=Maroon,
  citecolor=Blue,
  urlcolor=blue,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1.1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage[T1]{fontenc}
\usepackage{caption}
\usepackage{graphicx}
\usepackage{natbib}
\usepackage{fontawesome5}
\usepackage{subcaption}
\usepackage{amsfonts}
\usepackage{dsfont}
\usepackage{bbold}
\usepackage{xspace}
\usepackage{enumitem}
\usepackage{pifont}
\usepackage{wrapfig}
\usepackage{textpos}
\usepackage{array}
\usepackage{multicol}
\ifluatex
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\title{~\includegraphics[width=\textwidth,height=4cm]{img/LOGO-ENSAE.png}\\
\hspace*{0.333em}\textsc{Applied macroeconometrics}\\
\hspace*{0.333em}Les effets d'une hausse de l'Euribor 3-mois}
\author{Valentin Giust, Gautier Lenfant et Alain Quartier-la-Tente}
\date{}

\begin{document}
\maketitle

{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{2}
\tableofcontents
}
\vfill

The source code and this report is also available at \url{https://github.com/AQLT/AppliedMacroEuribor}.

\newpage

\hypertarget{introduction}{%
\section*{Introduction}\label{introduction}}
\addcontentsline{toc}{section}{Introduction}

In this essay, we build on a VAR model to quantify the effects of variations in the Euribor-3m rate (henceforth Euribor) on a series of key macroeconomic variables both at the Euro Area (EA) level, and in the particular case of France. To do so, we map out two scenarios involving different propagation mechanisms and relationships between the variables. For that purpose, we use time series spanning 1997-2018. In the first scenario (henceforth, \emph{Euribor-led scenario}), Euribor is the primary force at play. GDP reacts contemporaneously to the short term rate and impacts all the other variables. Unemployment follows contemporaneously. Both inflation and core inflation follow suit with delay. Our second scenario (henceforth, \emph{GDP-led scenario}) involves GDP as the primary force at play in the wake of a shock on the Euribor. The output level affects unemployment contemporaneously. The latter then impacts inflation and core inflation with delay. We apply these scenarios both to France and to the EA as a whole.

As far as the Euribor-led scenario is concerned, we find evidence that a unitary shock in the Euribor slightly brings down output and inflation in the case of the EA, while it only impacts output negatively in the case of France. We find no support for an unemployment response to the Euribor shock at the EA level. Strangely, the French labor market seems to improve in the immediate wake of the Euribor hike, before rapidly moving back to the zero region. As for the GDP-led scenario, we find suggestive evidence that a unitary shock on the Euribor rate brings down output for both France and the EA. However, only does EA inflation react negatively to such a short-term rate shock. In this second scenario, we find no significant impact of an Euribor shock onto the rate of unemployment, whether it be for France or the EA.

When it comes to the relationship between the short-term rate and the main macroeconomic variables, our VAR-based findings using the GDP-led scenario are consistent with some theoretical predictions of the basic Neo-keynesian model (henceforth, NKM): a tightening of financing in the short run has a negative impact on aggregate demand, which brings down inflation in a significant fashion.

In the first part (section \ref{sec:data}), we provide the origin of our empirical resources and present our data, along with a few stylized facts. We then present our empirical strategy and the features of our specification in the second part (section \ref{sec:model}). Finally, the last part sets forth the results of our estimations based on the two scenarios (section \ref{sec:est}).

\pagebreak

\hypertarget{sec:data}{%
\section{Presentation of the Data}\label{sec:data}}

\hypertarget{data-origin-and-features}{%
\subsection{Data origin and features}\label{data-origin-and-features}}

We exclusively rely on macroeconomic data provided by official statistical offices over a period of time spanning 1997-2018\footnote{
  We didn't take more recent data to avoid dealing with the impact of the COVID-19 crisis on the estimates.}. We stick to the following set of macroeconomic variables: Euribor rate (\(R_t\)), GDP in log (\(y_t\)), unemployment (\(U_t\)), standard inflation (\(\pi_t\)) and core inflation (\(\pi_t^{core}\)).

In the case of the EA, our data on GDP, unemployment and the Euribor rate originates from the \textbf{Eurostat} database. Further, our EA GDP time series is expressed in chain linked volumes (2010) and is seasonally and calendar adjusted. When it comes to the rates of standard and core inflation, we extract the time series from the \textbf{ECB} database and convert them into quarterly data. The unemployment rate is seasonally adjusted and covers people of both genders aged 15-74. Further specifics are provided in the code in appendix \ref{subsec:downloadingdata}. In the case of France, our data on GDP, unemployment and the rates of inflation is all extracted from the \textbf{Insee} database. The unemployment time series complies with the BIT's definition of unemployment and covers people of both genders aged 15-64. Obviously, the Euribor time series for France is common to that of the EA and originates from the \textbf{Eurostat} database.

\hypertarget{a-few-stylized-facts}{%
\subsection{A few stylized facts}\label{a-few-stylized-facts}}

In this subsection, we present a few stylized facts characterizing the macroeconomic trends in the EA between 1997 and 2018. We provide similar description in the particular case of France. Figure \ref{fig:plot-data-ue} sets forth the time series associated with our variables in the case of the EA. Figure \ref{fig:plot-data-fr}, on the other hand, exhibits the same series for France.

\begin{figure}
\centering
\includegraphics{img/markdown-plot-data-ue-1.pdf}
\caption{\label{fig:plot-data-ue}European Area data plots.}
\end{figure}

\begin{figure}
\centering
\includegraphics{img/markdown-plot-data-fr-1.pdf}
\caption{\label{fig:plot-data-fr}French data plots.}
\end{figure}

First, the 3 months Euribor rate is the benchmark rate of the Euro interbank lending market at a maturity of 3 months. It corresponds to the average unsecured lending rate between European banks which are required to report it daily based on transactions. Euribor is the only variable that cannot be declined by country, so that it is common, in our analysis, to both France and the EA. A barometer of the short term financing rate of European banks, the Euribor is a market rate. As such it is not directly controlled by the ECB though, in practice, the latter can influence the former to a large extent through the policy rate.

Euribor is linked to EONIA, the main very short term interbank interest rate, which has been replaced by a new benchmark rate called €STR. EONIA is critical to understanding the dynamics of Euribor. Although they are both interbank and unsecured lending rates, the crucial difference between them is the lending horizon: while Euribor is a 3 months rate, EONIA is an overnight rate. By means of an arbitrage relationship, EONIA must stay within the range outlined by the ECB deposit rate and the ECB main refinancing operations (MRO) rate. From the aftermath of the sovereign debt crisis, the ECB has increasingly resorted to unconventional monetary policy instruments to bring the economy back on track. The massive asset purchase programs conducted by the ECB have caused an unprecedented rise in the amounts of liquidity deposited by banks in their ECB accounts beyond the minimum reserve requirement. Amid unprecedented ECB-led liquidity injections over the past 10 years, EONIA has rapidly come down and stuck to the deposit floor rate. Therefore, even though EONIA is a market rate, the ECB is capable of controlling it closely through the fixing of deposit rates. Outside crisis times, the spread between Euribor and EONIA is roughly stable and revolves around 50 basis points. So, EONIA would be the ideal benchmark of the very short term interest rate in the EA as it is bounded by ECB policy rates and very low risk. Euribor is a little more complex as it encompasses other elements such as expectations of changes in the ECB policy rates over the next 3 months as well as stress / frictions on the interbank lending market.

Over the period spanning 1997-2018, Euribor roughly followed ECB rates with the noteworthy exception of spikes reflecting the stress of interbank markets amid the storm of the financial and economic crisis of the late 2000s and early 2010s. Before 2008, Euribor followed the cyclical moves of the ECB's rate policies and peaked twice above 5\% on a yearly basis. In the wake of the Euro's launching, Euribor increased substantially between 1997 and 2000, and between 2005 and 2008 alike. After 2008, Euribor started following a trend decline, except amid the sovereign debt financial turmoil (widening of the EONIA --- Euribor spread to 100 bps) and the two 2011 ECB rate hikes. Since 2015, Euribor has become negative and flat, revolving around -0.5\% on a yearly basis. Further, as a result of the ECB-led unconventional policies, the spread between EONIA and Euribor has further worn off.

We now turn to aggregate demand variables in the context of the EA. As far as GDP is concerned, we distinguish two periods or cycles: 2001 to 2008-09 and 2009 to 2020. The Covid-19 recession is not on our scope here. Average growth is higher in the first cycle (before 2008). The 2008 financial crisis begets a deep and protracted recession over several quarters. The second cycle features a double dip recession in 2011 due to the sovereign debt crisis in Europe, as well as two ill-thought-out ECB rate hikes visible on the Euribor, in the midst of Trichet's mandate. It is well established by the literature that this surprising twist in the monetary policy had a detrimental effect on output and unemployment in the EA. With the rollout of austerity measures in the fiscal front in several countries (Italy, Spain, Greece, etc.), economic growth failed to start off again. It was not until 2015 that the EA's macroeconomic context started to improve. While its dynamics are relatively similar to the EA as a whole, France has performed more poorly than the average of the monetary union in terms of GDP growth.

The two cycles described above apply to the unemployment and price variables as well. Unemployment is negatively correlated with GDP growth (i.e.~employment is positively correlated with GDP growth and prices increase more in expansion period). Inflation and core inflation are positively correlated with GDP growth (i.e.~prices increase more in expansion period). Consequentially, Euribor tends to be negatively correlated with unemployment but positively correlated with core and non-core inflation.

Unemployment seems to react with a lag to business cycle dynamics. This could be due to frictions on the labor market. While at the EA level, GDP slowdowns are observed in 2001, 2008-09 and 2011, the corresponding unemployment peaks appear in 2004, 2011 and 2014. After 2014, the weak expansion was sufficient to trigger a continuous improvement in the labor markets with unemployment reaching a 10-year low of 7\% right before the Covid-19 crisis.

In France, the dynamics are very similar but some differences are worth noting. Before 2008-09, the French labor market was usually tighter than in the EA: while unemployment was at 7.5\% in 2001 and 6.8\% in 2007 in France, it was at 8.5\% and 7.5\% at the same dates in the EA. The unemployment rise from 2009 to 2014-15 is very similar between France and the EA, though the peak is lower lesser in the hexagon. However, the expansionary phase starting from 2014 is much weaker in France. The peak unemployment in the French labor market lasted longer and the improving phase was much shier: from 10.3\% in 2015 to 8.4 in 2019 vs.~12\% in 2014 to 7.5\% in 2019 at the EA level.

The lag is less pronounced on price variables. At the EA level, prices variables bottomed out in 2009, 2014 and 2019, which is not fully consistent with the business cycle dynamics described above. In 2019 for instance, as EA labor markets were on an improving track, core-inflation was down. The coexistence of persistently low inflation with improving labor markets is a rather counter-intuitive pattern, insofar as it runs against the NKM. One explanation for the flattening of the Phillips curve in Europe is the decision made by some EA countries (e.g.~Spain) to deliberately bring down their labor costs and domestic prices in an attempt to enhance their competitiveness amid exchange rate fixity. In the aftermath of drastic cost cutting measures, Spain saw a substantial improvement in its current account, which boosted GDP and brought down unemployment with negligible pressure on domestic prices. More generally the flattening of the Phillips curve is the result of increasingly flexible labor markets, along with growing competition on the goods' markets. It is worth noting that France has not followed that austerity path with the same zeal. On the contrary, it has allowed for a bit more domestic inflation in the 2010s, at the cost of suffering more from the Euro.

In short, upon careful observation of the above graphs, it is clear that the macroeconomic history of the EA splits out in two periods, respectively spanning 1997-2008, and 2008-2018. The 2008 financial crisis is a watershed marking the start of a period of weaker macroeconomic performance, whether it be for France or the EA as a whole. It is worth noting that the macroeconomic situation is particularly depressed between 2012 and 2015 amid the austerity policies which were implemented in the wake of the sovereign debt crisis.

\hypertarget{sec:model}{%
\section{Presentation of the model}\label{sec:model}}

In this section, we describe and explain the features of our VAR specification. As a recall, we use the following notation:

\begin{itemize}
\tightlist
\item
  \(\Delta y_t\) for the difference of the log of the GDP;
\item
  \(U_t\) for the unemployment;
\item
  \(\pi_t\) for the inflation (year on year evolution of the HICP);
\item
  \(\pi_t^{core}\) for the core inflation (year on year evolution);
\item
  \(R_t\) for 3 months Euribor rate.
\end{itemize}

The same specification is used for EA and French data:

\begin{itemize}
\item
  We estimate a VAR model with a constant and a linear trend\footnote{
    At 5\%, the KPSS and the Augmented Dicker Fuller test conclude that all the series are stationary after having removed deterministic linear trend.}.
\item
  The number of lags of the model is determined by minimizing the Schwarz information criterion: we find that lag of 1 is enough to have a well specified model (no serial correlation, stability of the estimates and no ARCH effect).
\end{itemize}

Equations \eqref{eq:var-ea} and \eqref{eq:var-fr} shows the estimated parameters and the t-statistic of the VAR model, respectively for EA and French data.

\begin{equation}
\begin{pmatrix}
 \Delta y_{t} \\
U_{t} \\
\pi^{core}_{t} \\
\pi_{t} \\
R_{t} 
\end{pmatrix} = \begin{pmatrix}
 \underset{(0.01)}{0.03} & \underset{(0.00)}{-0.00} \\
\underset{(0.32)}{-0.76} & \underset{(0.00)}{0.00} \\
\underset{(0.00)}{0.00} & \underset{(0.00)}{0.00} \\
\underset{(0.01)}{0.01} & \underset{(0.00)}{-0.00} \\
\underset{(0.56)}{0.51} & \underset{(0.00)}{-0.00} 
\end{pmatrix} \begin{pmatrix} 1 \\ t \end{pmatrix}+\begin{pmatrix}
 \underset{(0.11)}{0.24} & \underset{(3.35)}{-16.20} & \underset{(0.03)}{0.08} & \underset{(0.07)}{0.32} & \underset{(5.84)}{31.29} \\
\underset{(0.00)}{-0.00} & \underset{(0.02)}{1.03} & \underset{(0.00)}{-0.00} & \underset{(0.00)}{-0.00} & \underset{(0.03)}{-0.03} \\
\underset{(0.21)}{-0.48} & \underset{(6.55)}{18.55} & \underset{(0.07)}{0.85} & \underset{(0.14)}{-0.00} & \underset{(11.44)}{-11.01} \\
\underset{(0.09)}{-0.11} & \underset{(2.75)}{4.25} & \underset{(0.03)}{0.04} & \underset{(0.06)}{0.90} & \underset{(4.79)}{10.51} \\
\underset{(0.00)}{-0.00} & \underset{(0.03)}{0.02} & \underset{(0.00)}{0.00} & \underset{(0.00)}{-0.00} & \underset{(0.05)}{0.89} 
\end{pmatrix} \begin{pmatrix}
 \Delta y_{t - 1} \\
U_{t - 1} \\
\pi^{core}_{t - 1} \\
\pi_{t - 1} \\
R_{t - 1} 
\end{pmatrix}+ \varepsilon^{EA}_t
\label{eq:var-ea}
\end{equation}

\begin{equation}
\begin{pmatrix}
 \Delta y_{t} \\
U_{t} \\
\pi^{core}_{t} \\
\pi_{t} \\
R_{t} 
\end{pmatrix} = \begin{pmatrix}
 \underset{(0.01)}{0.02} & \underset{(0.00)}{-0.00} \\
\underset{(0.60)}{0.18} & \underset{(0.00)}{-0.00} \\
\underset{(0.01)}{0.02} & \underset{(0.00)}{0.00} \\
\underset{(0.01)}{0.02} & \underset{(0.00)}{0.00} \\
\underset{(0.88)}{0.91} & \underset{(0.00)}{-0.00} 
\end{pmatrix} \begin{pmatrix} 1 \\ t \end{pmatrix}+\begin{pmatrix}
 \underset{(0.10)}{0.32} & \underset{(5.42)}{-27.97} & \underset{(0.05)}{0.06} & \underset{(0.11)}{0.53} & \underset{(7.91)}{45.45} \\
\underset{(0.00)}{-0.00} & \underset{(0.05)}{1.01} & \underset{(0.00)}{-0.00} & \underset{(0.00)}{-0.00} & \underset{(0.07)}{-0.10} \\
\underset{(0.13)}{-0.24} & \underset{(7.41)}{5.34} & \underset{(0.07)}{0.74} & \underset{(0.15)}{0.18} & \underset{(10.81)}{-14.48} \\
\underset{(0.06)}{-0.04} & \underset{(3.23)}{4.24} & \underset{(0.03)}{-0.06} & \underset{(0.06)}{0.75} & \underset{(4.72)}{3.97} \\
\underset{(0.00)}{-0.00} & \underset{(0.03)}{-0.05} & \underset{(0.00)}{0.00} & \underset{(0.00)}{-0.00} & \underset{(0.05)}{0.94} 
\end{pmatrix} \begin{pmatrix}
 \Delta y_{t - 1} \\
U_{t - 1} \\
\pi^{core}_{t - 1} \\
\pi_{t - 1} \\
R_{t - 1} 
\end{pmatrix}+ \varepsilon^{FR}_t
\label{eq:var-fr}
\end{equation}

Equation \eqref{eq:variances} shows the estimates of the covariance matrix of the residuals.
It is worth noticing that those matrices are not diagonal, meaning that a shock on a component is correlated to a shock on the other components.
This implies that we cannot directly estimate the impact of a shock on the Euribor rate, \(R_t\).
To do so, we need to make some assumptions as to the shocks' propagation. These assumptions are described in section \ref{sec:est}.

\begin{equation}
\mathbb{V}\varepsilon^{EA}_t = 
\begin{pmatrix}
 1.00 & -0.61 & -0.21 & 0.06 & 0.41 \\
-0.61 & 1.00 & 0.07 & 0.02 & -0.41 \\
-0.21 & 0.07 & 1.00 & 0.20 & -0.06 \\
0.06 & 0.02 & 0.20 & 1.00 & 0.25 \\
0.41 & -0.41 & -0.06 & 0.25 & 1.00 
\end{pmatrix}
\quad
\mathbb{V}\varepsilon^{FR}_t = 
\begin{pmatrix}
 1.00 & -0.44 & -0.06 & 0.24 & 0.48 \\
-0.44 & 1.00 & -0.06 & -0.23 & -0.40 \\
-0.06 & -0.06 & 1.00 & 0.13 & 0.00 \\
0.24 & -0.23 & 0.13 & 1.00 & 0.31 \\
0.48 & -0.40 & 0.00 & 0.31 & 1.00 
\end{pmatrix}
\label{eq:variances}
\end{equation}

\hypertarget{sec:est}{%
\section{Estimations of a shock on the 3 months Euribor rate}\label{sec:est}}

In this section, we depict the results of the our estimation endeavor.

\hypertarget{euribor-led-scenario}{%
\subsection{Euribor-led scenario}\label{euribor-led-scenario}}

In the first scenario --- henceforth, \emph{Euribor-led scenario} --- we suppose that Euribor is the primary force at play. GDP reacts contemporaneously to the short term rate and impacts all the other variables in turn. While unemployment follows contemporaneously, both inflation and core inflation follow with delay.

Statistically speaking, this scenario is equivalent to reordering our macroeconomic variables this way: \(\begin{pmatrix} R_{t} &\Delta y_{t} & U_{t} &\pi^{core}_{t} &\pi_{t} \end{pmatrix}\), and estimating a matrix \(B_1\) such that \(\mathbb V\varepsilon_t=B_1B_1'\) with the following constraints:
\[ B_1\sim\begin{pmatrix}1 & 0 & 0 & 0 & 0\\
* & 1 & 0 & 0 & 0\\
* & * & 1 & 0 & 0\\
0 & 0 & 0 & 1 & 0\\
0 & 0 & 0 & * & 1
\end{pmatrix}\]
Using the above-described data, we find the following \(B\) matrices\footnote{
  Note that not imposing any coefficient in the lower triangular matrix \(B_1\) to be null (and so to compute a Choleski decomposition) would not change the results. Indeed, in that case the estimates of the associated coefficients are closed to zero.}:
\[B_1^{EA} =\begin{pmatrix}
 0.288 & 0.000 & 0.000 & 0.000 & 0.000 \\
0.002 & 0.005 & 0.000 & 0.000 & 0.000 \\
-0.068 & -0.080 & 0.128 & 0.000 & 0.000 \\
0.000 & 0.000 & 0.000 & 0.002 & 0.000 \\
0.000 & 0.000 & 0.000 & 0.001 & 0.003 
\end{pmatrix}
\quad
B_1^{FR}=\begin{pmatrix}
 0.284 & 0.000 & 0.000 & 0.000 & 0.000 \\
0.002 & 0.003 & 0.000 & 0.000 & 0.000 \\
-0.078 & -0.054 & 0.170 & 0.000 & 0.000 \\
0.000 & 0.000 & 0.000 & 0.002 & 0.000 \\
0.000 & 0.000 & 0.000 & 0.001 & 0.004 
\end{pmatrix}\]

\hypertarget{gdp-led-scenario}{%
\subsection{GDP-led scenario}\label{gdp-led-scenario}}

In the second scenario --- henceforth, \emph{GDP-led scenario} --- we suppose that GDP is the primary force at play: a shock in the GDP contemporaneously affects all the variables. Unemployment follows contemporaneously, but a shock on the rate of unemployment only affects inflation and core inflation with delay. Finally, Euribor is contemporaneously affected by a shock on the other variables but the opposite does not hold: a shock on Euribor will only affect the other components with delay.

Statistically speaking, this scenario is equivalent to using the same order of variables as in equations \eqref{eq:var-ea} and \eqref{eq:var-fr} and to estimate a matrix \(B_2\), such that \(\mathbb V\varepsilon_t=B_2B_2'\) with the following constraints:
\[ B_2\sim\begin{pmatrix}1 & 0 & 0 & 0 & 0\\
* & 1 & 0 & 0 & 0\\
* & 0 & 1 & 0 & 0\\
* & 0 & * & 1 & 0\\
* & * & * & * & 1
\end{pmatrix}\]
Using the data, we find the following \(B\) matrices\footnote{
  Note that, as in the previous section, not imposing any coefficient in the lower triangular matrix \(B_2\) to be null (and so to compute a Choleski decomposition) would not change the results. Indeed, in that case the estimates of the associated coefficients are closed to zero.}:
\[B_2^{EA} =\begin{pmatrix}
 0.005 & 0.000 & 0.000 & 0.000 & 0.000 \\
-0.101 & 0.131 & 0.000 & 0.000 & 0.000 \\
-0.000 & 0.000 & 0.002 & 0.000 & 0.000 \\
0.000 & 0.000 & 0.001 & 0.003 & 0.000 \\
0.119 & -0.064 & 0.002 & 0.072 & 0.246 
\end{pmatrix}
\quad
B_2^{FR}=\begin{pmatrix}
 0.003 & 0.000 & 0.000 & 0.000 & 0.000 \\
-0.085 & 0.175 & 0.000 & 0.000 & 0.000 \\
-0.000 & 0.000 & 0.002 & 0.000 & 0.000 \\
0.001 & 0.000 & 0.001 & 0.004 & 0.000 \\
0.135 & -0.054 & 0.004 & 0.051 & 0.237 
\end{pmatrix}\]

\hypertarget{impulse-response-functions}{%
\subsection{Impulse response functions}\label{impulse-response-functions}}

Upon careful examination of the EA IRFs (figure \ref{fig:plot-irf-ea-euribor-lead}), we notice that, in the Euribor-led scenario, a unitary shock on Euribor has no real significant contemporaneous effect on GDP. Indeed, one may observe that the early spike in the GDP IRF is not statistically different from 0 as the gray confidence band contains the 0 red line.
However, this early spike in output induces a backlash in the real GDP which significantly decreases in the neighborhood of period 2. Thereafter, the effect of the shock wears off and GDP returns to non statistically significant regions. As for the response of unemployment, it is not statistically different from zero over the 20 period-long timeline of the IRF. As for inflation, it drops significantly below zero in the vicinity of periods 6 and 7, before retrieving insignificant levels. The response of core-inflation is not statistically different from zero over the whole IRF time line. As far as the 3 months Euribor is concerned, it keeps rising in the first quarter in the wake of the shock, then starts decreasing and returns to normal after 3 years.

Turning now to the case of France's IRFs (figure \ref{fig:plot-irf-fr-euribor-lead}), we notice that, in the Euribor-led scenario, a unitary shock on Euribor has a positive and significant effect on GDP in the very short run, before inducing a sharp and lingering drop in output between periods 3 and 7. Interestingly enough, unemployment drops significantly in the immediate aftermath of the shock because of the earlier described short term rise in output. As the output rise abates, the response of unemployment rapidly returns to the zero region. As for the response of inflation, it is significant and slightly positive in the immediate wake of the shock. While significant from a statistical standpoint, it remains practically negligible. As for core inflation, the response is significant, positive and more important than in the case of standard inflation.

Why do we get such results? It may seem counter-intuitive that an upward shock on the short term interest rate causes a short run rise in output, improves employment and boosts inflation in the case of France. We believe that our results are deeply driven by the patterns described in section \ref{sec:data} and making identification a hard deal. In the early stages of the Euro, the ECB would increase the short term interest rate in periods of expansion without damaging growth (2006-2007). The massive drops in the interest rates came out after the financial turmoil of the late 2000s, in the midst of a recession. It was not until 2015-2016 that growth came back around, long after the substantial interest rate cuts of 2009-2010.

Upon careful examination of the EA IRFs in the case of the GDP-led scenario, (figure \ref{fig:plot-irf-ea-gdp-lead}) we notice that a unitary shock on the Euribor rate has no significant effect on unemployment or core inflation. However, its does induce a significant decrease in output which returns to normal after around 3 years. Running against our observations in the Euribor-led scenario, inflation decreases in the first year and gradually returns to the non-significant region from period 8 onward. As for the Euribor rate, is slowly returns to normal. In the case of France (figure \ref{fig:plot-irf-fr-gdp-lead}), the drop in output is far more substantial, while the inflation's IRF features no trough.

When allowing GDP to be a leading force in the wake of an upward Euribor shock, we obtain results that are more in line with economic intuition. While it does not significantly damage labor markets, the drop in output does bring down inflation. It is worth mentioning that, in the Basic NK model, the conversion of the drop in output into lower prices goes through the falling labor demand and the dropping marginal costs of production in the context of perfectly competitive labor markets. Our findings in this second scenario are rather consistent with those theoretical predictions, insofar as we observe no significant effect on unemployment but an important response of prices.

\begin{figure}
\centering
\includegraphics{img/markdown-plot-irf-ea-euribor-lead-1.pdf}
\caption{\label{fig:plot-irf-ea-euribor-lead}Response functions of the Euro Area economy to a shock on the 3 months Euribor rate, \(R_t\) with a 95\% bootstrap confidence interval in the Euribor-led scenario.}
\end{figure}

\begin{figure}
\centering
\includegraphics{img/markdown-plot-irf-fr-euribor-lead-1.pdf}
\caption{\label{fig:plot-irf-fr-euribor-lead}Response functions on the French economy to a shock on the 3 months Euribor rates, \(R_t\) with a 95\% bootstrap confidence interval in the Euribor-led scenario.}
\end{figure}

\begin{figure}
\centering
\includegraphics{img/markdown-plot-irf-ea-gdp-lead-1.pdf}
\caption{\label{fig:plot-irf-ea-gdp-lead}Response functions of the Euro Area economy to a shock on the 3 months Euribor rates, \(R_t\) with a 95\% bootstrap confidence interval in the GDP-led scenario.}
\end{figure}

\begin{figure}
\centering
\includegraphics{img/markdown-plot-irf-fr-gdp-lead-1.pdf}
\caption{\label{fig:plot-irf-fr-gdp-lead}Response functions of the French economy to a shock on the 3 months Euribor rates, \(R_t\) with a 95\% bootstrap confidence interval in the GDP-led scenario.}
\end{figure}

\newpage

\hypertarget{concluding-remarks}{%
\section{Concluding remarks}\label{concluding-remarks}}

Using a VAR specification giving a leading role to output in the causal chain, we find results suggesting that a unitary shock on the 3 months Euribor rate does impact GDP in negative manner, be it for France or the EA as a whole. Our favorite GDP-led specification also predicts that an upward shock on the Euribor rate causes a significant short-term drop in the rate of inflation. Nevertheless, we find no suggestive evidence that a sudden hike in Euribor has any effect whatsoever on labor markets. This is consistent with basic NKM whereby a rise in the policy rate induces a fall in consumption and output, leading to a fall in marginal costs and prices through the clearing of labor markets.

\newpage
\appendix

\hypertarget{sec:code}{%
\section{Code}\label{sec:code}}

\hypertarget{functions}{%
\subsection{Functions}\label{functions}}

\texttt{Z\ -\ Fonctions.R} file.

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{require}\NormalTok{(ggplot2))\{}
    \FunctionTok{install.packages}\NormalTok{(ggplot2)}
    \FunctionTok{require}\NormalTok{(ggplot2)}
\NormalTok{\}}
\ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{require}\NormalTok{(forcats))\{}
    \FunctionTok{install.packages}\NormalTok{(forcats)}
    \FunctionTok{require}\NormalTok{(forcats)}
\NormalTok{\}}
\ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{require}\NormalTok{(ggfortify))\{}
    \FunctionTok{install.packages}\NormalTok{(ggfortify)}
    \FunctionTok{require}\NormalTok{(ggfortify)}
\NormalTok{\}}
\ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{require}\NormalTok{(patchwork))\{}
    \FunctionTok{install.packages}\NormalTok{(patchwork)}
    \FunctionTok{require}\NormalTok{(patchwork)}
\NormalTok{\}}
\CommentTok{\# On installe les packages suivants si non installés}
\NormalTok{packages }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"reshape2"}\NormalTok{, }\StringTok{"fUnitRoots"}\NormalTok{, }\StringTok{"tseries"}\NormalTok{)}
\FunctionTok{install.packages}\NormalTok{(}\FunctionTok{setdiff}\NormalTok{(packages, }\FunctionTok{rownames}\NormalTok{(}\FunctionTok{installed.packages}\NormalTok{())))  }

\NormalTok{plot\_irf }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(oir,}
                     \AttributeTok{labeller =} \StringTok{"label\_parsed"}\NormalTok{,}
                     \AttributeTok{recode =} \FunctionTok{c}\NormalTok{(}\StringTok{"Delta\textasciitilde{}y[t]"}\OtherTok{=} \StringTok{"dlGDP"}\NormalTok{,}
                                \StringTok{"U[t]"} \OtherTok{=} \StringTok{"U"}\NormalTok{,}
                                \StringTok{"pi[t]\^{}core"}\OtherTok{=}\StringTok{"underinf"}\NormalTok{,}
                                \StringTok{"pi[t]"}\OtherTok{=}\StringTok{"HICP"}\NormalTok{,}
                                \StringTok{"R[t]"} \OtherTok{=} \StringTok{"EURIBOR\_3M"}\NormalTok{))\{}
\NormalTok{    data\_plot }\OtherTok{\textless{}{-}} \FunctionTok{Reduce}\NormalTok{(}\ControlFlowTok{function}\NormalTok{(x,y) }\FunctionTok{merge}\NormalTok{(x,y,}\AttributeTok{by =} \FunctionTok{c}\NormalTok{(}\StringTok{"Var1"}\NormalTok{,}\StringTok{"Var2"}\NormalTok{)),}
                        \FunctionTok{list}\NormalTok{(reshape2}\SpecialCharTok{::}\FunctionTok{melt}\NormalTok{(oir}\SpecialCharTok{$}\NormalTok{irf}\SpecialCharTok{$}\NormalTok{EURIBOR\_3M),}
\NormalTok{                             reshape2}\SpecialCharTok{::}\FunctionTok{melt}\NormalTok{(oir}\SpecialCharTok{$}\NormalTok{Lower}\SpecialCharTok{$}\NormalTok{EURIBOR\_3M),}
\NormalTok{                             reshape2}\SpecialCharTok{::}\FunctionTok{melt}\NormalTok{(oir}\SpecialCharTok{$}\NormalTok{Upper}\SpecialCharTok{$}\NormalTok{EURIBOR\_3M)))}
\NormalTok{    data\_plot[,}\StringTok{"Var1"}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ data\_plot[,}\StringTok{"Var1"}\NormalTok{] }\SpecialCharTok{{-}}\DecValTok{1}
    \FunctionTok{colnames}\NormalTok{(data\_plot) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"x"}\NormalTok{,}\StringTok{"variable"}\NormalTok{,}\StringTok{"y"}\NormalTok{,}\StringTok{"lower"}\NormalTok{,}\StringTok{"upper"}\NormalTok{)}
\NormalTok{    data\_plot}\SpecialCharTok{$}\NormalTok{variable }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(data\_plot}\SpecialCharTok{$}\NormalTok{variable,}
                                 \AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"dlGDP"}\NormalTok{, }\StringTok{"U"}\NormalTok{, }\StringTok{"underinf"}\NormalTok{,}
                                            \StringTok{"HICP"}\NormalTok{, }\StringTok{"EURIBOR\_3M"}\NormalTok{),}
                                 \AttributeTok{ordered =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{    data\_plot}\SpecialCharTok{$}\NormalTok{variable }\OtherTok{\textless{}{-}} \FunctionTok{fct\_recode}\NormalTok{(data\_plot}\SpecialCharTok{$}\NormalTok{variable, }\SpecialCharTok{!!!}\NormalTok{recode)}
    \FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ data\_plot,}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x,}\AttributeTok{y=}\NormalTok{y,}\AttributeTok{ymin=}\NormalTok{lower,}\AttributeTok{ymax=}\NormalTok{upper)) }\SpecialCharTok{+}
        \FunctionTok{geom\_hline}\NormalTok{(}\AttributeTok{yintercept=}\DecValTok{0}\NormalTok{,}\AttributeTok{color=}\StringTok{"red"}\NormalTok{)}\SpecialCharTok{+}
        \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{color =} \StringTok{"darkblue"}\NormalTok{)}\SpecialCharTok{+}
        \FunctionTok{geom\_ribbon}\NormalTok{(}\AttributeTok{alpha=}\FloatTok{0.1}\NormalTok{) }\SpecialCharTok{+}
        \FunctionTok{facet\_wrap}\NormalTok{(}\FunctionTok{vars}\NormalTok{(variable),}
                   \AttributeTok{scales =} \StringTok{"free"}\NormalTok{, }\AttributeTok{nrow =} \DecValTok{2}\NormalTok{, }\AttributeTok{strip.position =} \StringTok{"top"}\NormalTok{,}
                   \AttributeTok{labeller =}\NormalTok{ labeller)}\SpecialCharTok{+}
        \FunctionTok{theme\_bw}\NormalTok{()}\SpecialCharTok{+}\FunctionTok{xlab}\NormalTok{(}\StringTok{""}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ylab}\NormalTok{(}\StringTok{""}\NormalTok{)   }
\NormalTok{\}}
\NormalTok{plot\_fevd }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(fevd,}
                      \AttributeTok{labeller =} \StringTok{"label\_parsed"}\NormalTok{,}
                      \AttributeTok{recode =} \FunctionTok{c}\NormalTok{(}\StringTok{"Delta\textasciitilde{}y[t]"}\OtherTok{=} \StringTok{"dlGDP"}\NormalTok{,}
                                 \StringTok{"U[t]"} \OtherTok{=} \StringTok{"U"}\NormalTok{,}
                                 \StringTok{"pi[t]\^{}core"}\OtherTok{=}\StringTok{"underinf"}\NormalTok{,}
                                 \StringTok{"pi[t]"}\OtherTok{=}\StringTok{"HICP"}\NormalTok{,}
                                 \StringTok{"R[t]"} \OtherTok{=} \StringTok{"EURIBOR\_3M"}\NormalTok{))\{}
\NormalTok{    data\_plot }\OtherTok{\textless{}{-}} \FunctionTok{Reduce}\NormalTok{(rbind,}
                        \FunctionTok{lapply}\NormalTok{(}\FunctionTok{names}\NormalTok{(fevd), }\ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{                            d }\OtherTok{\textless{}{-}}\NormalTok{ reshape2}\SpecialCharTok{::}\FunctionTok{melt}\NormalTok{(fevd[[x]])}
\NormalTok{                            d}\SpecialCharTok{$}\NormalTok{var\_comp }\OtherTok{=}\NormalTok{ x}
\NormalTok{                            d}
\NormalTok{                        \}))}
    \FunctionTok{colnames}\NormalTok{(data\_plot) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"horizon"}\NormalTok{,}\StringTok{"variable"}\NormalTok{,}\StringTok{"y"}\NormalTok{,}\StringTok{"decomp"}\NormalTok{)}
\NormalTok{    data\_plot}\SpecialCharTok{$}\NormalTok{y }\OtherTok{\textless{}{-}} \DecValTok{100} \SpecialCharTok{*}\NormalTok{data\_plot}\SpecialCharTok{$}\NormalTok{y}
\NormalTok{    data\_plot}\SpecialCharTok{$}\NormalTok{decomp }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(data\_plot}\SpecialCharTok{$}\NormalTok{decomp,}
                               \AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"dlGDP"}\NormalTok{, }\StringTok{"U"}\NormalTok{, }\StringTok{"underinf"}\NormalTok{,}
                                          \StringTok{"HICP"}\NormalTok{, }\StringTok{"EURIBOR\_3M"}\NormalTok{),}
                               \AttributeTok{ordered =} \ConstantTok{TRUE}\NormalTok{)}
    
\NormalTok{    data\_plot}\SpecialCharTok{$}\NormalTok{variable }\OtherTok{=} \FunctionTok{fct\_recode}\NormalTok{(data\_plot}\SpecialCharTok{$}\NormalTok{variable, }\SpecialCharTok{!!!}\NormalTok{recode)}
\NormalTok{    data\_plot}\SpecialCharTok{$}\NormalTok{decomp }\OtherTok{=} \FunctionTok{fct\_recode}\NormalTok{(data\_plot}\SpecialCharTok{$}\NormalTok{decomp, }\SpecialCharTok{!!!}\NormalTok{recode)}
    
    \FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ data\_plot, }\AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ horizon, }\AttributeTok{y =}\NormalTok{ y,}
                                           \AttributeTok{fill =}\NormalTok{ variable)) }\SpecialCharTok{+}
        \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{)}\SpecialCharTok{+}
        \FunctionTok{facet\_wrap}\NormalTok{(}\FunctionTok{vars}\NormalTok{(decomp),}
                   \AttributeTok{scales =} \StringTok{"free"}\NormalTok{, }\AttributeTok{strip.position =} \StringTok{"top"}\NormalTok{,}
                   \AttributeTok{labeller =}\NormalTok{ labeller)}\SpecialCharTok{+}
        \FunctionTok{theme\_bw}\NormalTok{()}\SpecialCharTok{+}\FunctionTok{xlab}\NormalTok{(}\StringTok{"Horizon"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ylab}\NormalTok{(}\StringTok{"Percentage"}\NormalTok{) }\SpecialCharTok{+}
        \FunctionTok{scale\_fill\_viridis\_d}\NormalTok{(}
            \AttributeTok{breaks =} \FunctionTok{levels}\NormalTok{(data\_plot}\SpecialCharTok{$}\NormalTok{variable),}
            \AttributeTok{labels =} \FunctionTok{unlist}\NormalTok{(}\FunctionTok{label\_parsed}\NormalTok{(}\FunctionTok{levels}\NormalTok{(data\_plot}\SpecialCharTok{$}\NormalTok{variable))))}
\NormalTok{\}}
\NormalTok{plot\_ts }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(data, x)\{}
\NormalTok{    rename\_fun }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{        x }\OtherTok{\textless{}{-}} \FunctionTok{sub}\NormalTok{(}\StringTok{"dlGDP"}\NormalTok{, }\StringTok{"Delta\textasciitilde{}y[t]"}\NormalTok{ , x)}
\NormalTok{        x }\OtherTok{\textless{}{-}} \FunctionTok{sub}\NormalTok{(}\StringTok{"underinf"}\NormalTok{, }\StringTok{"pi[t]\^{}\{core\}"}\NormalTok{ , x)}
\NormalTok{        x }\OtherTok{\textless{}{-}} \FunctionTok{sub}\NormalTok{(}\StringTok{"HICP"}\NormalTok{, }\StringTok{"pi[t]"}\NormalTok{ , x)}
\NormalTok{        x }\OtherTok{\textless{}{-}} \FunctionTok{sub}\NormalTok{(}\StringTok{"EURIBOR\_3M"}\NormalTok{, }\StringTok{"R[t]"}\NormalTok{ , x)}
\NormalTok{        x }\OtherTok{\textless{}{-}} \FunctionTok{sub}\NormalTok{(}\StringTok{"\^{}U$"}\NormalTok{, }\StringTok{"U[t]"}\NormalTok{ , x)}
\NormalTok{        x}
\NormalTok{    \}}
    \FunctionTok{autoplot}\NormalTok{(data[,x]) }\SpecialCharTok{+} 
        \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \FunctionTok{label\_parsed}\NormalTok{(}\FunctionTok{rename\_fun}\NormalTok{(x))[[}\DecValTok{1}\NormalTok{]][[}\DecValTok{1}\NormalTok{]])}
\NormalTok{\}}
\NormalTok{latexify\_var }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(model, }\AttributeTok{nb\_dec =} \DecValTok{1}\NormalTok{, }\AttributeTok{align =} \ConstantTok{FALSE}\NormalTok{,}
                         \AttributeTok{se =} \ConstantTok{FALSE}\NormalTok{) \{}
\NormalTok{    rename\_fun }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{        x }\OtherTok{\textless{}{-}} \FunctionTok{sub}\NormalTok{(}\StringTok{"dlGDP"}\NormalTok{, }\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{Delta y"}\NormalTok{ , x, }\AttributeTok{fixed =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{        x }\OtherTok{\textless{}{-}} \FunctionTok{sub}\NormalTok{(}\StringTok{"underinf"}\NormalTok{, }\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{pi\^{}\{core\}"}\NormalTok{ , x, }\AttributeTok{fixed =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{        x }\OtherTok{\textless{}{-}} \FunctionTok{sub}\NormalTok{(}\StringTok{"HICP"}\NormalTok{, }\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{pi"}\NormalTok{ , x, }\AttributeTok{fixed =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{        x }\OtherTok{\textless{}{-}} \FunctionTok{sub}\NormalTok{(}\StringTok{"EURIBOR\_3M"}\NormalTok{, }\StringTok{"R"}\NormalTok{ , x, }\AttributeTok{fixed =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{        x}
\NormalTok{    \}}
    \CommentTok{\# rename\_fun = function(x) \{gsub("\_", "\textbackslash{}\textbackslash{}\_", x,fixed = TRUE)\}}
\NormalTok{    coefficients }\OtherTok{\textless{}{-}} \FunctionTok{coef}\NormalTok{(model)}
\NormalTok{    names\_var }\OtherTok{\textless{}{-}} \FunctionTok{rename\_fun}\NormalTok{(}\FunctionTok{names}\NormalTok{(coefficients))}
    
\NormalTok{    coef\_mats }\OtherTok{\textless{}{-}} \FunctionTok{lapply}\NormalTok{(}\FunctionTok{seq\_len}\NormalTok{(model}\SpecialCharTok{$}\NormalTok{p),}\ControlFlowTok{function}\NormalTok{(lag)\{}
        \FunctionTok{sapply}\NormalTok{(coefficients,}\ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{            x[}\FunctionTok{grep}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{.l\%i$"}\NormalTok{,lag),}\FunctionTok{rownames}\NormalTok{(x)), }\StringTok{"Estimate"}\NormalTok{]}
\NormalTok{        \})}
\NormalTok{    \})}
    
\NormalTok{    coef\_mats\_se }\OtherTok{\textless{}{-}} \FunctionTok{lapply}\NormalTok{(}\FunctionTok{seq\_len}\NormalTok{(model}\SpecialCharTok{$}\NormalTok{p),}\ControlFlowTok{function}\NormalTok{(lag)\{}
        \ControlFlowTok{if}\NormalTok{(se)\{}
            \FunctionTok{sapply}\NormalTok{(coefficients,}\ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{                x[}\FunctionTok{grep}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{.l\%i$"}\NormalTok{,lag),}\FunctionTok{rownames}\NormalTok{(x)), }\StringTok{"Std. Error"}\NormalTok{]}
\NormalTok{            \})}
\NormalTok{        \}}\ControlFlowTok{else}\NormalTok{\{}
            \ConstantTok{NULL}
\NormalTok{        \}}
\NormalTok{    \})}
\NormalTok{    X\_tex }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\FunctionTok{latexify\_const\_trend}\NormalTok{(model, }\AttributeTok{se =}\NormalTok{ se, }\AttributeTok{nb\_dec =}\NormalTok{ nb\_dec),}
              \FunctionTok{sapply}\NormalTok{(}\FunctionTok{seq\_along}\NormalTok{(coef\_mats), }\ControlFlowTok{function}\NormalTok{(lag)\{}
                  \FunctionTok{paste}\NormalTok{(}\FunctionTok{latexify\_mat}\NormalTok{(coef\_mats[[lag]],}
                                     \AttributeTok{se\_mat =}\NormalTok{ coef\_mats\_se[[lag]],}
                                     \AttributeTok{nb\_dec =}\NormalTok{ nb\_dec),}
                        \FunctionTok{latexify\_y}\NormalTok{(names\_var, }\AttributeTok{lag =}\NormalTok{ lag)  }
\NormalTok{                  )}
\NormalTok{              \})) }
    
\NormalTok{    Y\_tex }\OtherTok{=} \FunctionTok{latexify\_y}\NormalTok{(names\_var, }\AttributeTok{lag =} \DecValTok{0}\NormalTok{)}
    \ControlFlowTok{if}\NormalTok{ (align)\{}
        \CommentTok{\# Concaténation de la constante}
\NormalTok{        X\_tex }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\FunctionTok{paste}\NormalTok{(X\_tex[}\DecValTok{1}\NormalTok{], X\_tex[}\DecValTok{2}\NormalTok{], }\AttributeTok{sep =} \StringTok{" + "}\NormalTok{),}
\NormalTok{                  X\_tex[}\SpecialCharTok{{-}}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{)])}
\NormalTok{        X\_tex }\OtherTok{=} \FunctionTok{paste}\NormalTok{(X\_tex,}
                      \AttributeTok{collapse =} \StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{nonumber }\SpecialCharTok{\textbackslash{}\textbackslash{}\textbackslash{}\textbackslash{}}\StringTok{ }\SpecialCharTok{\textbackslash{}n}\StringTok{ \&+"}\NormalTok{)}
\NormalTok{        res }\OtherTok{=} \FunctionTok{sprintf}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{begin\{align\} }\SpecialCharTok{\textbackslash{}n}\StringTok{\%s \&= \%s + }\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{varepsilon\_t }\SpecialCharTok{\textbackslash{}n\textbackslash{}\textbackslash{}}\StringTok{end\{align\}"}\NormalTok{,}
\NormalTok{                      Y\_tex, X\_tex)}
\NormalTok{    \}}\ControlFlowTok{else}\NormalTok{\{}
\NormalTok{        X\_tex }\OtherTok{=} \FunctionTok{paste}\NormalTok{(X\_tex,}
                      \AttributeTok{collapse =} \StringTok{"+"}\NormalTok{)}
\NormalTok{        res }\OtherTok{=} \FunctionTok{sprintf}\NormalTok{(}\StringTok{"\%s = \%s+ }\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{varepsilon\_t}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{,}
\NormalTok{                      Y\_tex, X\_tex)}
\NormalTok{    \}}
    \FunctionTok{return}\NormalTok{ (res)}
\NormalTok{\}}

\NormalTok{latexify\_mat }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(mat, }\AttributeTok{se\_mat =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{nb\_dec =} \DecValTok{1}\NormalTok{)\{}
\NormalTok{    mat }\OtherTok{=} \FunctionTok{formatC}\NormalTok{(mat, }\AttributeTok{digits =}\NormalTok{ nb\_dec, }\AttributeTok{format =} \StringTok{"f"}\NormalTok{)}
    \ControlFlowTok{if}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.null}\NormalTok{(se\_mat))\{}
\NormalTok{        se\_mat }\OtherTok{=} \FunctionTok{formatC}\NormalTok{(se\_mat, }\AttributeTok{digits =}\NormalTok{ nb\_dec, }\AttributeTok{format =} \StringTok{"f"}\NormalTok{)}
\NormalTok{        se\_mat }\OtherTok{=} \FunctionTok{apply}\NormalTok{(se\_mat,}\DecValTok{2}\NormalTok{,}
                       \ControlFlowTok{function}\NormalTok{(x) }\FunctionTok{paste0}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{underset\{("}\NormalTok{,x,}\StringTok{")\}"}\NormalTok{))}
\NormalTok{        mat }\OtherTok{=} \FunctionTok{apply}\NormalTok{(mat,}\DecValTok{2}\NormalTok{,}
                    \ControlFlowTok{function}\NormalTok{(x) }\FunctionTok{paste0}\NormalTok{(}\StringTok{"\{"}\NormalTok{,x,}\StringTok{"\}"}\NormalTok{))}
\NormalTok{        mat[]}\OtherTok{=} \FunctionTok{paste0}\NormalTok{(se\_mat,mat)}
\NormalTok{    \}}
    
\NormalTok{    mat }\OtherTok{=} \FunctionTok{paste}\NormalTok{(}\FunctionTok{apply}\NormalTok{(mat,}\DecValTok{1}\NormalTok{, paste, }\AttributeTok{collapse =} \StringTok{" \& "}\NormalTok{), }\AttributeTok{collapse =} \StringTok{" }\SpecialCharTok{\textbackslash{}\textbackslash{}\textbackslash{}\textbackslash{}\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{    mat }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{begin\{pmatrix\}}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{,mat,}
                 \StringTok{"}\SpecialCharTok{\textbackslash{}n\textbackslash{}\textbackslash{}}\StringTok{end\{pmatrix\}"}\NormalTok{)}
\NormalTok{    mat}
\NormalTok{\}}
\NormalTok{latexify\_const\_trend }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(model, }\AttributeTok{nb\_dec =} \DecValTok{1}\NormalTok{, }\AttributeTok{se =} \ConstantTok{FALSE}\NormalTok{)\{}
\NormalTok{    coefficients }\OtherTok{\textless{}{-}} \FunctionTok{coef}\NormalTok{(model)}
\NormalTok{    const\_trend }\OtherTok{\textless{}{-}} \FunctionTok{t}\NormalTok{(}\FunctionTok{sapply}\NormalTok{(coefficients,}\ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{        x[}\FunctionTok{grep}\NormalTok{(}\StringTok{"(\^{}const$)|(\^{}trend$)"}\NormalTok{,}\FunctionTok{rownames}\NormalTok{(x)), }\StringTok{"Estimate"}\NormalTok{]}
\NormalTok{    \})) }
    \ControlFlowTok{if}\NormalTok{(se)\{}
\NormalTok{        const\_trend\_se }\OtherTok{\textless{}{-}} \FunctionTok{t}\NormalTok{(}\FunctionTok{sapply}\NormalTok{(coefficients,}\ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{            x[}\FunctionTok{grep}\NormalTok{(}\StringTok{"(\^{}const$)|(\^{}trend$)"}\NormalTok{,}\FunctionTok{rownames}\NormalTok{(x)), }\StringTok{"Std. Error"}\NormalTok{]}
\NormalTok{        \}))  }
\NormalTok{    \}}\ControlFlowTok{else}\NormalTok{\{}
\NormalTok{        const\_trend\_se }\OtherTok{\textless{}{-}} \ConstantTok{NULL}
\NormalTok{    \}}
    
    \ControlFlowTok{if}\NormalTok{(model}\SpecialCharTok{$}\NormalTok{type }\SpecialCharTok{==} \StringTok{"both"}\NormalTok{)\{}
        \CommentTok{\# constante + tendance}
\NormalTok{        res }\OtherTok{\textless{}{-}} \FunctionTok{latexify\_mat}\NormalTok{(const\_trend,}
                            \AttributeTok{se\_mat =}\NormalTok{ const\_trend\_se,}
                            \AttributeTok{nb\_dec =}\NormalTok{ nb\_dec)}
\NormalTok{        res }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(res,}
                     \StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{begin\{pmatrix\} 1 }\SpecialCharTok{\textbackslash{}\textbackslash{}\textbackslash{}\textbackslash{}}\StringTok{ t }\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{end\{pmatrix\}"}\NormalTok{)}
\NormalTok{    \}}
    \ControlFlowTok{if}\NormalTok{(model}\SpecialCharTok{$}\NormalTok{type }\SpecialCharTok{==} \StringTok{"trend"}\NormalTok{)\{}
\NormalTok{        res }\OtherTok{\textless{}{-}} \FunctionTok{latexify\_mat}\NormalTok{(const\_trend,}
                            \AttributeTok{se\_mat =}\NormalTok{ const\_trend\_se,}
                            \AttributeTok{nb\_dec =}\NormalTok{ nb\_dec)}
\NormalTok{        res }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(res,}
                     \StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{begin\{pmatrix\} 1 }\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{end\{pmatrix\}"}\NormalTok{)}
\NormalTok{    \}}
    \ControlFlowTok{if}\NormalTok{(model}\SpecialCharTok{$}\NormalTok{type }\SpecialCharTok{==} \StringTok{"const"}\NormalTok{)\{}
\NormalTok{        res }\OtherTok{\textless{}{-}} \FunctionTok{latexify\_mat}\NormalTok{(const\_trend,}
                            \AttributeTok{se\_mat =}\NormalTok{ const\_trend\_se,}
                            \AttributeTok{nb\_dec =}\NormalTok{ nb\_dec)}
\NormalTok{        res }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(res,}
                     \StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{begin\{pmatrix\} t  }\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{end\{pmatrix\}"}\NormalTok{)}
\NormalTok{    \}}
    \ControlFlowTok{if}\NormalTok{(model}\SpecialCharTok{$}\NormalTok{type }\SpecialCharTok{==} \StringTok{"none"}\NormalTok{)\{}
\NormalTok{        res }\OtherTok{\textless{}{-}} \ConstantTok{NULL}
\NormalTok{    \}}
\NormalTok{    res}
\NormalTok{\}}
\NormalTok{latexify\_y }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(vec, }\AttributeTok{lag =} \DecValTok{0}\NormalTok{)\{}
\NormalTok{    vec }\OtherTok{=} \FunctionTok{sprintf}\NormalTok{(}\StringTok{"\%s\_\{t\%s\}"}\NormalTok{,vec,}
                  \FunctionTok{ifelse}\NormalTok{(lag }\SpecialCharTok{==} \DecValTok{0}\NormalTok{,}\StringTok{""}\NormalTok{,}
                         \FunctionTok{sprintf}\NormalTok{(}\StringTok{" {-} \%i"}\NormalTok{, lag)))}
    \FunctionTok{paste}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{begin\{pmatrix\}}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{,}
          \FunctionTok{paste}\NormalTok{(vec,}\AttributeTok{collapse =} \StringTok{" }\SpecialCharTok{\textbackslash{}\textbackslash{}\textbackslash{}\textbackslash{}\textbackslash{}n}\StringTok{"}\NormalTok{),}
          \StringTok{"}\SpecialCharTok{\textbackslash{}n\textbackslash{}\textbackslash{}}\StringTok{end\{pmatrix\}"}\NormalTok{)}
\NormalTok{\}}


\CommentTok{\# Téléchargement données depuis BDM}
\NormalTok{lectureBDM }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(idbank, ...)}
\NormalTok{\{}
    \CommentTok{\#On récupère les idbank et on supprime les éventuels espaces}
\NormalTok{    idbank}\OtherTok{\textless{}{-}}\FunctionTok{gsub}\NormalTok{(}\StringTok{" "}\NormalTok{,}\StringTok{""}\NormalTok{,}\FunctionTok{c}\NormalTok{(idbank,}\FunctionTok{unlist}\NormalTok{(}\FunctionTok{list}\NormalTok{(...))))}
    
    \CommentTok{\#Les url pour télécharger le(s) série(s)}
\NormalTok{    UrlData }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(}\StringTok{"https://bdm.insee.fr/series/sdmx/data/SERIES\_BDM/"}\NormalTok{,}
                      \FunctionTok{paste}\NormalTok{(idbank,}\AttributeTok{collapse =} \StringTok{"+"}\NormalTok{))}
    
    \FunctionTok{tryCatch}\NormalTok{(\{}
\NormalTok{        dataBDM }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(rsdmx}\SpecialCharTok{::}\FunctionTok{readSDMX}\NormalTok{(UrlData,}\AttributeTok{isURL =}\NormalTok{ T),}
                                 \AttributeTok{stringsAsFactors=}\ConstantTok{TRUE}\NormalTok{)}
\NormalTok{    \},}\AttributeTok{error=}\ControlFlowTok{function}\NormalTok{(e)\{}
        \FunctionTok{stop}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Il y a une erreur dans le téléchargement des données."}\NormalTok{,}
                    \StringTok{"Vérifier le lien}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{,}
\NormalTok{                    UrlData),}
             \AttributeTok{call. =} \ConstantTok{FALSE}\NormalTok{)}
\NormalTok{    \})}
    
\NormalTok{    FREQ }\OtherTok{\textless{}{-}} \FunctionTok{levels}\NormalTok{(}\FunctionTok{factor}\NormalTok{(dataBDM}\SpecialCharTok{$}\NormalTok{FREQ))}
    
    \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{length}\NormalTok{(FREQ)}\SpecialCharTok{!=}\DecValTok{1}\NormalTok{)}
        \FunctionTok{stop}\NormalTok{(}\StringTok{"Les séries ne sont pas de la même périodicité !"}\NormalTok{)}
    
\NormalTok{    freq}\OtherTok{\textless{}{-}}\ControlFlowTok{switch}\NormalTok{(FREQ}
\NormalTok{                 ,}\AttributeTok{M=}\DecValTok{12}
\NormalTok{                 ,}\AttributeTok{B=}\DecValTok{6}
\NormalTok{                 ,}\AttributeTok{T=}\DecValTok{4}
\NormalTok{                 ,}\AttributeTok{S=}\DecValTok{2}
\NormalTok{                 ,}\AttributeTok{A=}\DecValTok{1}\NormalTok{)}
    \CommentTok{\# On détermine le format de la colonne qui contient les dates}
    \CommentTok{\# en fonction de la fréquence}
\NormalTok{    sepDate}\OtherTok{\textless{}{-}}\ControlFlowTok{switch}\NormalTok{(FREQ}
\NormalTok{                    ,}\AttributeTok{M=}\StringTok{"{-}"}
\NormalTok{                    ,}\AttributeTok{B=}\StringTok{"{-}B"}
\NormalTok{                    ,}\AttributeTok{T=}\StringTok{"{-}Q"}
\NormalTok{                    ,}\AttributeTok{S=}\StringTok{"{-}S"}
\NormalTok{                    ,}\AttributeTok{A=}\StringTok{" "}\NormalTok{)}
\NormalTok{    dataBDM }\OtherTok{\textless{}{-}}\NormalTok{ reshape2}\SpecialCharTok{::}\FunctionTok{dcast}\NormalTok{(dataBDM,}\StringTok{"TIME\_PERIOD \textasciitilde{} IDBANK"}\NormalTok{,}
                               \AttributeTok{value.var =} \StringTok{"OBS\_VALUE"}\NormalTok{)}
\NormalTok{    dataBDM }\OtherTok{\textless{}{-}}\NormalTok{ dataBDM[}\FunctionTok{order}\NormalTok{(dataBDM}\SpecialCharTok{$}\NormalTok{TIME\_PERIOD),]}
    
    \CommentTok{\#On récupère la première date}
\NormalTok{    dateDeb }\OtherTok{\textless{}{-}}\NormalTok{ dataBDM}\SpecialCharTok{$}\NormalTok{TIME\_PERIOD[}\DecValTok{1}\NormalTok{]}
\NormalTok{    dateDeb }\OtherTok{\textless{}{-}} \FunctionTok{regmatches}\NormalTok{(dateDeb,}\FunctionTok{gregexpr}\NormalTok{(sepDate,dateDeb),}\AttributeTok{invert=}\NormalTok{T)[[}\DecValTok{1}\NormalTok{]]}
\NormalTok{    dateDeb }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(dateDeb)}
    
    \CommentTok{\#On supprime la colonne des dates et on convertit les séries en numérique}
\NormalTok{    dataBDM}\SpecialCharTok{$}\NormalTok{TIME\_PERIOD }\OtherTok{\textless{}{-}} \ConstantTok{NULL}
\NormalTok{    dataBDM }\OtherTok{\textless{}{-}} \FunctionTok{apply}\NormalTok{(dataBDM,}\DecValTok{2}\NormalTok{,as.numeric)}
    
    \ControlFlowTok{if}\NormalTok{(}\FunctionTok{ncol}\NormalTok{(dataBDM) }\SpecialCharTok{!=} \FunctionTok{length}\NormalTok{(idbank))}
        \FunctionTok{warning}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Le ou les idbank suivant n\textquotesingle{}existent pas :"}\NormalTok{,}
                      \FunctionTok{paste}\NormalTok{(}\FunctionTok{grep}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\FunctionTok{colnames}\NormalTok{(dataBDM),}\AttributeTok{collapse=}\StringTok{"|"}\NormalTok{),}
\NormalTok{                                 idbank,}\AttributeTok{value=}\NormalTok{T,}\AttributeTok{invert =}\NormalTok{ T),}
                            \AttributeTok{collapse=}\StringTok{", "}\NormalTok{)))}
    \ControlFlowTok{if}\NormalTok{(}\FunctionTok{ncol}\NormalTok{(dataBDM) }\SpecialCharTok{\textgreater{}} \DecValTok{1}\NormalTok{)\{}
        \CommentTok{\# On a au moins 2 colonnes : on replace les colonnes dans le même ordre }
        \CommentTok{\# que les séries en entrée}
        
        \CommentTok{\# On ne garde que les idbank présents dans la base}
\NormalTok{        idbank }\OtherTok{\textless{}{-}}\NormalTok{ idbank[idbank }\SpecialCharTok{\%in\%} \FunctionTok{colnames}\NormalTok{(dataBDM)]}
\NormalTok{        dataBDM }\OtherTok{\textless{}{-}}\NormalTok{ dataBDM[,idbank]}
\NormalTok{    \}}
\NormalTok{    dataBDM }\OtherTok{\textless{}{-}} \FunctionTok{ts}\NormalTok{(dataBDM,}\AttributeTok{start=}\NormalTok{dateDeb,}\AttributeTok{freq=}\NormalTok{freq)}
    \FunctionTok{return}\NormalTok{(dataBDM)}
\NormalTok{\}}

\CommentTok{\# fonctions pour tester la stationarité des données}
\NormalTok{stationnarity\_test }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x, }\AttributeTok{detrend =} \ConstantTok{TRUE}\NormalTok{)\{}
    \ControlFlowTok{if}\NormalTok{(detrend)\{}
\NormalTok{        x\_detrend }\OtherTok{=} \FunctionTok{residuals}\NormalTok{(}\FunctionTok{lm}\NormalTok{(x }\SpecialCharTok{\textasciitilde{}} \FunctionTok{time}\NormalTok{(x)))}
\NormalTok{    \}}\ControlFlowTok{else}\NormalTok{\{}
\NormalTok{        x\_detrend }\OtherTok{=}\NormalTok{ x}
\NormalTok{    \}}
    
\NormalTok{    kpss\_test }\OtherTok{=}\NormalTok{ tseries}\SpecialCharTok{::}\FunctionTok{kpss.test}\NormalTok{(x\_detrend) }\CommentTok{\# H\_0 série stationnaire}
\NormalTok{    adf }\OtherTok{=} \FunctionTok{adfTest\_valid}\NormalTok{(x\_detrend, }\AttributeTok{kmax =} \DecValTok{20}\NormalTok{, }\AttributeTok{type =} \StringTok{"nc"}\NormalTok{) }\CommentTok{\# H\_0 racine unitaire}
\NormalTok{    result }\OtherTok{=} \FunctionTok{c}\NormalTok{(kpss\_test}\SpecialCharTok{$}\NormalTok{p.value,}
\NormalTok{               adf}\SpecialCharTok{@}\NormalTok{test}\SpecialCharTok{$}\NormalTok{p.value)}
    \FunctionTok{names}\NormalTok{(result) }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"KPSS test"}\NormalTok{, }\StringTok{"ADF test"}\NormalTok{)}
\NormalTok{    result}
\NormalTok{\}}
\NormalTok{Qtests }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(series, }\AttributeTok{k =} \DecValTok{24}\NormalTok{, }\AttributeTok{fitdf=}\DecValTok{0}\NormalTok{) \{}
\NormalTok{    pvals }\OtherTok{\textless{}{-}} \FunctionTok{apply}\NormalTok{(}\FunctionTok{matrix}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\NormalTok{k), }\DecValTok{1}\NormalTok{, }\AttributeTok{FUN=}\ControlFlowTok{function}\NormalTok{(l) \{}
\NormalTok{        pval }\OtherTok{\textless{}{-}} \ControlFlowTok{if}\NormalTok{ (l}\SpecialCharTok{\textless{}=}\NormalTok{fitdf) }\ConstantTok{NA} \ControlFlowTok{else} \FunctionTok{Box.test}\NormalTok{(series,}
                                               \AttributeTok{lag=}\NormalTok{l,}
                                               \AttributeTok{type=}\StringTok{"Ljung{-}Box"}\NormalTok{, }
                                               \AttributeTok{fitdf=}\NormalTok{fitdf)}\SpecialCharTok{$}\NormalTok{p.value }
        \FunctionTok{return}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"lag"}\OtherTok{=}\NormalTok{l,}\StringTok{"pval"}\OtherTok{=}\NormalTok{pval))}
\NormalTok{    \})}
    \FunctionTok{return}\NormalTok{(}\FunctionTok{t}\NormalTok{(pvals))}
\NormalTok{\}}
\CommentTok{\# tests ADF jusqu’à ce que les résidus ne soient pas autocorrélés}
\NormalTok{adfTest\_valid }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(series, kmax,type)\{}
\NormalTok{    k }\OtherTok{\textless{}{-}} \DecValTok{0}
\NormalTok{    noautocorr }\OtherTok{\textless{}{-}} \DecValTok{0}
    \ControlFlowTok{while}\NormalTok{ (noautocorr}\SpecialCharTok{==}\DecValTok{0}\NormalTok{)\{}
        \FunctionTok{suppressWarnings}\NormalTok{(\{}
\NormalTok{            adf }\OtherTok{\textless{}{-}}\NormalTok{ fUnitRoots}\SpecialCharTok{::}\FunctionTok{adfTest}\NormalTok{(series,}\AttributeTok{lags=}\NormalTok{k,}\AttributeTok{type=}\NormalTok{type)}
\NormalTok{        \})}
        
\NormalTok{        pvals }\OtherTok{\textless{}{-}} \FunctionTok{Qtests}\NormalTok{(adf}\SpecialCharTok{@}\NormalTok{test}\SpecialCharTok{$}\NormalTok{lm}\SpecialCharTok{$}\NormalTok{residuals,}
                        \DecValTok{24}\NormalTok{,}
                        \AttributeTok{fitdf=}\FunctionTok{length}\NormalTok{(adf}\SpecialCharTok{@}\NormalTok{test}\SpecialCharTok{$}\NormalTok{lm}\SpecialCharTok{$}\NormalTok{coefficients))[,}\DecValTok{2}\NormalTok{] }
        \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{sum}\NormalTok{(pvals}\SpecialCharTok{\textless{}}\FloatTok{0.05}\NormalTok{,}\AttributeTok{na.rm=}\NormalTok{T) }\SpecialCharTok{==} \DecValTok{0}\NormalTok{) \{}
\NormalTok{            noautocorr }\OtherTok{\textless{}{-}} \DecValTok{1}\NormalTok{;}
\NormalTok{            adf }\OtherTok{\textless{}{-}}\NormalTok{ fUnitRoots}\SpecialCharTok{::}\FunctionTok{adfTest}\NormalTok{(series,}\AttributeTok{lags=}\NormalTok{k,}\AttributeTok{type=}\NormalTok{type)}
\NormalTok{        \}}
\NormalTok{        k }\OtherTok{\textless{}{-}}\NormalTok{ k }\SpecialCharTok{+} \DecValTok{1}
\NormalTok{    \}}
    \FunctionTok{return}\NormalTok{(adf)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{subsec:downloadingdata}{%
\subsection{Downloading of the data}\label{subsec:downloadingdata}}

\texttt{1-extraction\_donnees.R} file.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ecb)}
\FunctionTok{library}\NormalTok{(eurostat)}
\FunctionTok{library}\NormalTok{(zoo)}

\FunctionTok{source}\NormalTok{(}\StringTok{"R/Z {-} Fonctions.R"}\NormalTok{,}\AttributeTok{encoding =} \StringTok{"UTF{-}8"}\NormalTok{)}

\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\# DATA GATHERING \& CLEANING \#\#\#\#\#\#\#\#\#\#\#\#\#\#\# }

\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\DocumentationTok{\#\#\#\#\#\#\#\#\# DONNEES UE \#\#\#\#\#\#\#\#\#\#\#\#\#}
\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\DocumentationTok{\#\#EURIBOR\_3M}
\NormalTok{euri}\OtherTok{\textless{}{-}}\FunctionTok{get\_eurostat}\NormalTok{(}
    \StringTok{"irt\_st\_q"}\NormalTok{,}
    \AttributeTok{time\_format=}\StringTok{"date"}\NormalTok{,}
    \AttributeTok{filters=}\FunctionTok{list}\NormalTok{(}\AttributeTok{geo=}\StringTok{"EA"}\NormalTok{,}\AttributeTok{int\_rt=}\StringTok{"IRT\_M3"}\NormalTok{)}
\NormalTok{)}
\NormalTok{euribor }\OtherTok{\textless{}{-}} \FunctionTok{ts}\NormalTok{(euri}\SpecialCharTok{$}\NormalTok{values,}\AttributeTok{start=}\FunctionTok{c}\NormalTok{(}\FunctionTok{substr}\NormalTok{(euri}\SpecialCharTok{$}\NormalTok{time[}\DecValTok{1}\NormalTok{],}\DecValTok{1}\NormalTok{,}\DecValTok{4}\NormalTok{),}\DecValTok{1}\NormalTok{), }\AttributeTok{freq=}\DecValTok{4}\NormalTok{)}

\DocumentationTok{\#\#GDP}

\NormalTok{gdp}\OtherTok{\textless{}{-}}\FunctionTok{get\_eurostat}\NormalTok{(}
    \StringTok{"namq\_10\_gdp"}\NormalTok{,}
    \AttributeTok{time\_format=}\StringTok{"date"}\NormalTok{,}
    \AttributeTok{filters=}\FunctionTok{list}\NormalTok{(}\AttributeTok{geo=}\StringTok{"EA"}\NormalTok{, }\AttributeTok{s\_adj=}\StringTok{"SCA"}\NormalTok{, }\AttributeTok{na\_item=}\StringTok{"B1GQ"}\NormalTok{, }\AttributeTok{unit=}\StringTok{"CLV10\_MEUR"}\NormalTok{)}
\NormalTok{)}
\NormalTok{gdp }\OtherTok{\textless{}{-}} \FunctionTok{log}\NormalTok{(}\FunctionTok{ts}\NormalTok{(gdp}\SpecialCharTok{$}\NormalTok{values,}\AttributeTok{start=}\FunctionTok{c}\NormalTok{(}\FunctionTok{substr}\NormalTok{(gdp}\SpecialCharTok{$}\NormalTok{time[}\DecValTok{1}\NormalTok{],}\DecValTok{1}\NormalTok{,}\DecValTok{4}\NormalTok{),}\DecValTok{1}\NormalTok{), }\AttributeTok{freq=}\DecValTok{4}\NormalTok{))}
\NormalTok{dlgdp }\OtherTok{\textless{}{-}} \FunctionTok{diff}\NormalTok{(gdp)}


\DocumentationTok{\#\#unemployment}
\CommentTok{\# Extraction du taux de chômage harmonisé pour les personnes de 15 à 74 ans,}
\CommentTok{\# En ne faisant pas de distinction par sexe et en prenant }
\CommentTok{\# le pourcentage dans la population active}
\NormalTok{unem}\OtherTok{\textless{}{-}}\FunctionTok{get\_eurostat}\NormalTok{(}
    \StringTok{"une\_rt\_q"}\NormalTok{,}
    \AttributeTok{time\_format=}\StringTok{"date"}\NormalTok{,}
    \AttributeTok{filters=}\FunctionTok{list}\NormalTok{(}\AttributeTok{age =} \StringTok{"Y15{-}74"}\NormalTok{, }\AttributeTok{geo=}\StringTok{"EA19"}\NormalTok{,}\AttributeTok{sex=}\StringTok{"T"}\NormalTok{,}\AttributeTok{s\_adj =} \StringTok{"SA"}\NormalTok{, }\AttributeTok{unit=}\StringTok{"PC\_ACT"}\NormalTok{)}
\NormalTok{) }
\NormalTok{unemp}\OtherTok{\textless{}{-}}\FunctionTok{ts}\NormalTok{(unem}\SpecialCharTok{$}\NormalTok{values,}\AttributeTok{start=}\FunctionTok{c}\NormalTok{(}\FunctionTok{substr}\NormalTok{(unem}\SpecialCharTok{$}\NormalTok{time[}\DecValTok{1}\NormalTok{],}\DecValTok{1}\NormalTok{,}\DecValTok{4}\NormalTok{),}\DecValTok{1}\NormalTok{), }\AttributeTok{freq=}\DecValTok{4}\NormalTok{)}

\DocumentationTok{\#\# inflation and underlying inflation (From ECB database)}

\NormalTok{hicp }\OtherTok{\textless{}{-}}\FunctionTok{get\_data}\NormalTok{(}\StringTok{"ICP.M.U2.N.000000.4.INX"}
\NormalTok{)}
\NormalTok{hicp}\OtherTok{\textless{}{-}}\FunctionTok{ts}\NormalTok{(hicp}\SpecialCharTok{$}\NormalTok{obsvalue,}
         \AttributeTok{start=}\FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\FunctionTok{substr}\NormalTok{(hicp}\SpecialCharTok{$}\NormalTok{obstime[}\DecValTok{1}\NormalTok{],}\DecValTok{1}\NormalTok{,}\DecValTok{4}\NormalTok{),}
                 \FunctionTok{substr}\NormalTok{(hicp}\SpecialCharTok{$}\NormalTok{obstime[}\DecValTok{1}\NormalTok{],}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{))),}
         \AttributeTok{freq=}\DecValTok{12}\NormalTok{)}
\NormalTok{hicpq }\OtherTok{\textless{}{-}} \FunctionTok{aggregate}\NormalTok{(}\FunctionTok{as.zoo}\NormalTok{(hicp), yearqtr, mean)}
\NormalTok{hicpq }\OtherTok{\textless{}{-}} \FunctionTok{as.ts}\NormalTok{(hicpq)}
\NormalTok{hicpq }\OtherTok{\textless{}{-}}\NormalTok{ hicpq}\SpecialCharTok{/}\FunctionTok{lag}\NormalTok{(hicpq,}\SpecialCharTok{{-}}\DecValTok{4}\NormalTok{)}\SpecialCharTok{{-}}\DecValTok{1} \CommentTok{\# glissement annuel}

\NormalTok{infex }\OtherTok{\textless{}{-}}\FunctionTok{get\_data}\NormalTok{(}\StringTok{"ICP.M.U2.N.XEF000.4.INX"}
\NormalTok{)}
\NormalTok{infex}\OtherTok{\textless{}{-}}\FunctionTok{ts}\NormalTok{(infex}\SpecialCharTok{$}\NormalTok{obsvalue,}
          \AttributeTok{start=}\FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\FunctionTok{substr}\NormalTok{(infex}\SpecialCharTok{$}\NormalTok{obstime[}\DecValTok{1}\NormalTok{],}\DecValTok{1}\NormalTok{,}\DecValTok{4}\NormalTok{),}
                             \FunctionTok{substr}\NormalTok{(infex}\SpecialCharTok{$}\NormalTok{obstime[}\DecValTok{1}\NormalTok{],}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{))),}
          \AttributeTok{freq=}\DecValTok{12}\NormalTok{)}
\NormalTok{infexq }\OtherTok{\textless{}{-}} \FunctionTok{aggregate}\NormalTok{(}\FunctionTok{as.zoo}\NormalTok{(infex), yearqtr, mean)}
\NormalTok{infexq }\OtherTok{\textless{}{-}} \FunctionTok{as.ts}\NormalTok{(infexq)}
\NormalTok{infexq }\OtherTok{\textless{}{-}}\NormalTok{ infexq}\SpecialCharTok{/}\FunctionTok{lag}\NormalTok{(infexq,}\SpecialCharTok{{-}}\DecValTok{4}\NormalTok{)}\SpecialCharTok{{-}}\DecValTok{1} \CommentTok{\# glissement annuel}

\NormalTok{data }\OtherTok{\textless{}{-}} \FunctionTok{ts.union}\NormalTok{(euribor, dlgdp,gdp, unemp, hicpq, infexq)}
\FunctionTok{colnames}\NormalTok{(data)}\OtherTok{\textless{}{-}}\FunctionTok{cbind}\NormalTok{(}\StringTok{"EURIBOR\_3M"}\NormalTok{, }\StringTok{"dlGDP"}\NormalTok{,}\StringTok{"lGDP"}\NormalTok{,}
                      \StringTok{"U"}\NormalTok{,}\StringTok{"HICP"}\NormalTok{,}\StringTok{"underinf"}\NormalTok{)}
\FunctionTok{saveRDS}\NormalTok{(data, }\AttributeTok{file=}\StringTok{"data/data\_UE.RDS"}\NormalTok{)}

\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\DocumentationTok{\#\#\#\#\#\#\#\#\# DONNEES FR \#\#\#\#\#\#\#\#\#\#\#\#\#}
\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}

\CommentTok{\# Indice d\textquotesingle{}inflation sous{-}jacente {-} Base 2015 {-} Ensemble des ménages {-} }
\CommentTok{\# France métropolitaine {-} Ensemble}
\NormalTok{infex }\OtherTok{\textless{}{-}} \FunctionTok{lectureBDM}\NormalTok{(}\StringTok{"001769686"}\NormalTok{)}
\NormalTok{infexq }\OtherTok{\textless{}{-}} \FunctionTok{aggregate}\NormalTok{(}\FunctionTok{as.zoo}\NormalTok{(infex), yearqtr, mean)}
\NormalTok{infexq }\OtherTok{\textless{}{-}} \FunctionTok{as.ts}\NormalTok{(infexq)}
\NormalTok{infexq }\OtherTok{\textless{}{-}}\NormalTok{ infexq}\SpecialCharTok{/}\FunctionTok{lag}\NormalTok{(infexq,}\SpecialCharTok{{-}}\DecValTok{4}\NormalTok{)}\SpecialCharTok{{-}}\DecValTok{1} \CommentTok{\# glissement annuel}

\CommentTok{\# Produit intérieur brut total {-} Volume aux prix de l\textquotesingle{}année précédente chaînés {-} }
\CommentTok{\# Série CVS{-}CJO aux prix de l\textquotesingle{}année précédente chaînés {-} Série CVS{-}CJO}
\NormalTok{gdp }\OtherTok{\textless{}{-}} \FunctionTok{log}\NormalTok{(}\FunctionTok{lectureBDM}\NormalTok{(}\StringTok{"010565708"}\NormalTok{))}
\NormalTok{dlgdp }\OtherTok{\textless{}{-}} \FunctionTok{diff}\NormalTok{(gdp)}

\CommentTok{\# Taux de chômage au sens du BIT {-} Ensemble {-} France métropolitaine {-} }
\CommentTok{\# Données CVS}
\NormalTok{unemp }\OtherTok{\textless{}{-}} \FunctionTok{lectureBDM}\NormalTok{(}\StringTok{"001688526"}\NormalTok{)}

\NormalTok{hicp }\OtherTok{\textless{}{-}} \FunctionTok{lectureBDM}\NormalTok{(}\StringTok{"001759971"}\NormalTok{)}
\NormalTok{hicpq }\OtherTok{\textless{}{-}} \FunctionTok{aggregate}\NormalTok{(}\FunctionTok{as.zoo}\NormalTok{(hicp), yearqtr, mean)}
\NormalTok{hicpq }\OtherTok{\textless{}{-}} \FunctionTok{as.ts}\NormalTok{(hicpq)}
\NormalTok{hicpq }\OtherTok{\textless{}{-}}\NormalTok{ hicpq}\SpecialCharTok{/}\FunctionTok{lag}\NormalTok{(hicpq,}\SpecialCharTok{{-}}\DecValTok{4}\NormalTok{)}\SpecialCharTok{{-}}\DecValTok{1} \CommentTok{\# glissement annuel}

\NormalTok{data }\OtherTok{\textless{}{-}} \FunctionTok{ts.union}\NormalTok{(euribor, dlgdp,gdp, unemp, hicpq, infexq)}
\FunctionTok{colnames}\NormalTok{(data)}\OtherTok{\textless{}{-}}\FunctionTok{cbind}\NormalTok{(}\StringTok{"EURIBOR\_3M"}\NormalTok{, }\StringTok{"dlGDP"}\NormalTok{,}\StringTok{"lGDP"}\NormalTok{,}
                      \StringTok{"U"}\NormalTok{,}\StringTok{"HICP"}\NormalTok{,}\StringTok{"underinf"}\NormalTok{)}
\FunctionTok{saveRDS}\NormalTok{(data, }\AttributeTok{file=}\StringTok{"data/data\_FR.RDS"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{estimation-of-the-models}{%
\subsection{Estimation of the models}\label{estimation-of-the-models}}

\hypertarget{european-area}{%
\subsubsection{European area}\label{european-area}}

\texttt{2.1-estimation\_modeles\ EA.R} file.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(vars)}

\FunctionTok{source}\NormalTok{(}\StringTok{"R/Z {-} Fonctions.R"}\NormalTok{,}\AttributeTok{encoding =} \StringTok{"UTF{-}8"}\NormalTok{)}

\NormalTok{dataUE }\OtherTok{\textless{}{-}} \FunctionTok{readRDS}\NormalTok{(}\StringTok{"data/data\_UE.RDS"}\NormalTok{)}
\NormalTok{dataUE }\OtherTok{\textless{}{-}} \FunctionTok{na.omit}\NormalTok{(dataUE[,}\FunctionTok{c}\NormalTok{(}\StringTok{"EURIBOR\_3M"}\NormalTok{,}\StringTok{"dlGDP"}\NormalTok{,}
                            \StringTok{"U"}\NormalTok{, }\StringTok{"HICP"}\NormalTok{, }\StringTok{"underinf"}\NormalTok{)])}
\NormalTok{dataUE }\OtherTok{\textless{}{-}} \FunctionTok{window}\NormalTok{(dataUE, }\AttributeTok{end =} \FunctionTok{c}\NormalTok{(}\DecValTok{2018}\NormalTok{,}\DecValTok{4}\NormalTok{))}

\FunctionTok{round}\NormalTok{(}\FunctionTok{sapply}\NormalTok{(dataUE, stationnarity\_test), }\DecValTok{3}\NormalTok{)}
\CommentTok{\# Au seuil de 5 \%, lorsque l\textquotesingle{}on enlève une tendance linéaire on trouve que}
\CommentTok{\# toutes les séries stationnaires selon kpss et selon ADF.}
\CommentTok{\# C\textquotesingle{}est pourquoi on effectue un VAR avec un modèle contenant constante + }
\CommentTok{\# tendance linéaire.}

\NormalTok{p }\OtherTok{\textless{}{-}}\NormalTok{ (}\FunctionTok{plot\_ts}\NormalTok{(dataUE, }\StringTok{"EURIBOR\_3M"}\NormalTok{) }\SpecialCharTok{+}
          \FunctionTok{plot\_ts}\NormalTok{(dataUE, }\StringTok{"dlGDP"}\NormalTok{))}\SpecialCharTok{/}\NormalTok{(}
              \FunctionTok{plot\_ts}\NormalTok{(dataUE, }\StringTok{"U"}\NormalTok{) }\SpecialCharTok{+} 
                  \FunctionTok{plot\_ts}\NormalTok{(dataUE, }\StringTok{"HICP"}\NormalTok{) }\SpecialCharTok{+} 
                  \FunctionTok{plot\_ts}\NormalTok{(dataUE, }\StringTok{"underinf"}\NormalTok{)}
\NormalTok{              )}
\NormalTok{(p }\SpecialCharTok{\&} \FunctionTok{theme\_minimal}\NormalTok{() )}\SpecialCharTok{+} 
    \FunctionTok{plot\_annotation}\NormalTok{(}\AttributeTok{title =} \StringTok{\textquotesingle{}European Area\textquotesingle{}}\NormalTok{)}

\NormalTok{var\_ordering1 }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"dlGDP"}\NormalTok{,}
                 \StringTok{"U"}\NormalTok{, }\StringTok{"underinf"}\NormalTok{,}\StringTok{"HICP"}\NormalTok{, }\StringTok{"EURIBOR\_3M"}\NormalTok{)}
\NormalTok{var\_ordering2 }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"EURIBOR\_3M"}\NormalTok{, }\StringTok{"dlGDP"}\NormalTok{,}
                 \StringTok{"U"}\NormalTok{, }\StringTok{"underinf"}\NormalTok{,}\StringTok{"HICP"}\NormalTok{)}

\CommentTok{\#Select AIC{-}suggested lag}
\NormalTok{lagselect }\OtherTok{\textless{}{-}}\FunctionTok{VARselect}\NormalTok{(dataUE[,var\_ordering1],}
                      \AttributeTok{lag.max=}\DecValTok{6}\NormalTok{,}\AttributeTok{type=}\StringTok{"const"}\NormalTok{)}
\CommentTok{\# Le critère de Schwartz suggère de ne retenir qu\textquotesingle{}un lag}
\NormalTok{lagselect}
\NormalTok{p\_retenu }\OtherTok{=} \DecValTok{1}

\CommentTok{\# L\textquotesingle{}ordre des variables n\textquotesingle{}aura pas d\textquotesingle{}impact sur les analyses du VAR}
\CommentTok{\# mais uniquement dans la spécification du sVAR}
\NormalTok{model }\OtherTok{\textless{}{-}} \FunctionTok{VAR}\NormalTok{(dataUE[,var\_ordering1],}
           \AttributeTok{p =}\NormalTok{ p\_retenu,}\AttributeTok{type =} \StringTok{"both"}\NormalTok{)}
\NormalTok{model2 }\OtherTok{\textless{}{-}} \FunctionTok{VAR}\NormalTok{(dataUE[,var\_ordering2],}
             \AttributeTok{p =}\NormalTok{ p\_retenu,}\AttributeTok{type =} \StringTok{"both"}\NormalTok{)}
\CommentTok{\# Pas d\textquotesingle{}autocorrélation dans les résidus}
\FunctionTok{serial.test}\NormalTok{(model)}

\CommentTok{\# Pas d\textquotesingle{}hétéroscédasticité dans les résidus}
\FunctionTok{arch.test}\NormalTok{(model)}
\CommentTok{\# Ni de problème de stabilité dans les coefficients}
\FunctionTok{plot}\NormalTok{(}\FunctionTok{stability}\NormalTok{(model))}

\CommentTok{\# Pour récupérer le code latex du VAR :}
\FunctionTok{cat}\NormalTok{(}\FunctionTok{latexify\_var}\NormalTok{(model,}\AttributeTok{align =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{nb\_dec =} \DecValTok{2}\NormalTok{, }\AttributeTok{se=}\ConstantTok{TRUE}\NormalTok{))}
\FunctionTok{cat}\NormalTok{(}\FunctionTok{latexify\_mat}\NormalTok{(}\FunctionTok{cor}\NormalTok{(}\FunctionTok{residuals}\NormalTok{(model)), }\AttributeTok{nb\_dec =} \DecValTok{2}\NormalTok{))}

\NormalTok{Bmat\_chol }\OtherTok{\textless{}{-}} \FunctionTok{diag}\NormalTok{(}\AttributeTok{nrow =} \DecValTok{5}\NormalTok{)}
\NormalTok{Bmat\_chol[}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ Bmat\_chol[}\DecValTok{3}\NormalTok{,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{] }\OtherTok{\textless{}{-}} 
\NormalTok{    Bmat\_chol[}\DecValTok{4}\NormalTok{,(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{)] }\OtherTok{\textless{}{-}}\NormalTok{ Bmat\_chol[}\DecValTok{5}\NormalTok{,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{] }\OtherTok{\textless{}{-}} 
    \FunctionTok{diag}\NormalTok{(Bmat\_chol) }\OtherTok{\textless{}{-}} \ConstantTok{NA}
\NormalTok{Bmat\_chol }\CommentTok{\# Choleski}

\NormalTok{Bmat }\OtherTok{\textless{}{-}} \FunctionTok{diag}\NormalTok{(}\AttributeTok{nrow =} \DecValTok{5}\NormalTok{)}
\NormalTok{Bmat[}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ Bmat[}\DecValTok{3}\NormalTok{,}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{)] }\OtherTok{\textless{}{-}} 
\NormalTok{    Bmat[}\DecValTok{4}\NormalTok{,}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{)] }\OtherTok{\textless{}{-}}\NormalTok{ Bmat[}\DecValTok{5}\NormalTok{,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{] }\OtherTok{\textless{}{-}} 
    \FunctionTok{diag}\NormalTok{(Bmat) }\OtherTok{\textless{}{-}} \ConstantTok{NA}
\NormalTok{Bmat }\CommentTok{\# affiné}

\NormalTok{Bmat2 }\OtherTok{\textless{}{-}} \FunctionTok{diag}\NormalTok{(}\AttributeTok{nrow =} \DecValTok{5}\NormalTok{)}
\NormalTok{Bmat2[}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ Bmat2[}\DecValTok{3}\NormalTok{,}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{)] }\OtherTok{\textless{}{-}} 
\NormalTok{    Bmat2[}\DecValTok{5}\NormalTok{,}\DecValTok{4}\NormalTok{] }\OtherTok{\textless{}{-}} 
    \FunctionTok{diag}\NormalTok{(Bmat2) }\OtherTok{\textless{}{-}} \ConstantTok{NA}
\NormalTok{Bmat2 }\CommentTok{\# affiné}

\NormalTok{smodel1\_chol }\OtherTok{\textless{}{-}} \FunctionTok{SVAR}\NormalTok{(model,}\AttributeTok{Bmat =}\NormalTok{ Bmat\_chol)}
\NormalTok{smodel1 }\OtherTok{\textless{}{-}} \FunctionTok{SVAR}\NormalTok{(model,}\AttributeTok{Bmat =}\NormalTok{ Bmat) }
\NormalTok{smodel1\_chol}\SpecialCharTok{$}\NormalTok{B }\CommentTok{\# coefficients imposés à 0 proches de 0}
\NormalTok{smodel1}\SpecialCharTok{$}\NormalTok{B}
\FunctionTok{cat}\NormalTok{(}\FunctionTok{latexify\_mat}\NormalTok{(smodel1}\SpecialCharTok{$}\NormalTok{B, }\AttributeTok{nb\_dec =} \DecValTok{3}\NormalTok{))}

\NormalTok{smodel2 }\OtherTok{\textless{}{-}} \FunctionTok{SVAR}\NormalTok{(model2,}\AttributeTok{Bmat =}\NormalTok{ Bmat\_chol)}
\NormalTok{smodel2}
\CommentTok{\# les coefficients que l\textquotesingle{}on va imposer à 0 sont estimés à 0}
\CommentTok{\# en utilisant la décomposition de choleski}
\CommentTok{\# Les mêmes résultats sont donc trouvés entre les deux méthodes}
\NormalTok{smodel2 }\OtherTok{\textless{}{-}} \FunctionTok{SVAR}\NormalTok{(model2,}\AttributeTok{Bmat =}\NormalTok{ Bmat2)}
\NormalTok{smodel2}
\FunctionTok{cat}\NormalTok{(}\FunctionTok{latexify\_mat}\NormalTok{(smodel2}\SpecialCharTok{$}\NormalTok{B, }\AttributeTok{nb\_dec =} \DecValTok{3}\NormalTok{))}

\CommentTok{\# Utilisation de Blanchard Quah, non commenté dans le rapport}
\NormalTok{smodel1\_bq }\OtherTok{\textless{}{-}} \FunctionTok{BQ}\NormalTok{(model)}
\NormalTok{smodel2\_bq }\OtherTok{\textless{}{-}} \FunctionTok{BQ}\NormalTok{(model2)}

\NormalTok{irf\_1 }\OtherTok{\textless{}{-}} \FunctionTok{irf}\NormalTok{(smodel1, }\AttributeTok{impulse =} \StringTok{"EURIBOR\_3M"}\NormalTok{,}
           \AttributeTok{n.ahead =} \DecValTok{20}\NormalTok{)}
\NormalTok{irf\_1\_chol }\OtherTok{\textless{}{-}} \FunctionTok{irf}\NormalTok{(smodel1\_chol, }\AttributeTok{impulse =} \StringTok{"EURIBOR\_3M"}\NormalTok{,}
             \AttributeTok{n.ahead =} \DecValTok{20}\NormalTok{)}
\NormalTok{irf\_1\_bq }\OtherTok{\textless{}{-}} \FunctionTok{irf}\NormalTok{(smodel1\_bq, }\AttributeTok{impulse =} \StringTok{"EURIBOR\_3M"}\NormalTok{,}
                  \AttributeTok{n.ahead =} \DecValTok{20}\NormalTok{)}

\NormalTok{irf\_2 }\OtherTok{\textless{}{-}} \FunctionTok{irf}\NormalTok{(smodel2, }\AttributeTok{impulse =} \StringTok{"EURIBOR\_3M"}\NormalTok{,}
             \AttributeTok{n.ahead =} \DecValTok{20}\NormalTok{)}
\NormalTok{irf\_2\_bq }\OtherTok{\textless{}{-}} \FunctionTok{irf}\NormalTok{(smodel2\_bq, }\AttributeTok{impulse =} \StringTok{"EURIBOR\_3M"}\NormalTok{,}
                \AttributeTok{n.ahead =} \DecValTok{20}\NormalTok{)}

\FunctionTok{plot\_irf}\NormalTok{(irf\_1\_chol) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Choleski {-} GDP{-}led"}\NormalTok{) }
\CommentTok{\# Quasiment même résultat comme attendu :}
\FunctionTok{plot\_irf}\NormalTok{(irf\_1) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Matrice affinée {-} GDP{-}led"}\NormalTok{)}

\CommentTok{\# Non commenté dans le rapport}
\FunctionTok{plot\_irf}\NormalTok{(irf\_1\_bq) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Blanchard Quah decomposition {-} GDP{-}led"}\NormalTok{) }

\FunctionTok{plot\_irf}\NormalTok{(irf\_2) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Matrice affinée {-} Euribor{-}led"}\NormalTok{)}
\CommentTok{\# Non commenté dans le rapport}
\FunctionTok{plot\_irf}\NormalTok{(irf\_2\_bq) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Blanchard Quah decomposition {-} Euribor{-}led"}\NormalTok{)}

\CommentTok{\# decomposition de la variance}
\CommentTok{\# non utilisé dans le rapport}
\NormalTok{fevd }\OtherTok{\textless{}{-}} \FunctionTok{fevd}\NormalTok{(smodel1, }\AttributeTok{n.ahead =} \DecValTok{20}\NormalTok{)}
\FunctionTok{plot\_fevd}\NormalTok{(fevd)}


\FunctionTok{saveRDS}\NormalTok{(model, }\StringTok{"data/models\_EA/var\_model.RDS"}\NormalTok{)}
\FunctionTok{saveRDS}\NormalTok{(irf\_1, }\StringTok{"data/models\_EA/irf\_1"}\NormalTok{)}
\FunctionTok{saveRDS}\NormalTok{(irf\_1\_chol, }\StringTok{"data/models\_EA/irf\_1\_chol"}\NormalTok{)}
\FunctionTok{saveRDS}\NormalTok{(irf\_1\_bq, }\StringTok{"data/models\_EA/irf\_1\_bq"}\NormalTok{)}
\FunctionTok{saveRDS}\NormalTok{(irf\_2, }\StringTok{"data/models\_EA/irf\_2"}\NormalTok{)}
\FunctionTok{saveRDS}\NormalTok{(irf\_2\_bq, }\StringTok{"data/models\_EA/irf\_2\_bq"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{france}{%
\subsubsection{France}\label{france}}

\texttt{2.2-estimation\_modeles\ FR.R} file.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(vars)}

\FunctionTok{source}\NormalTok{(}\StringTok{"R/Z {-} Fonctions.R"}\NormalTok{,}\AttributeTok{encoding =} \StringTok{"UTF{-}8"}\NormalTok{)}

\NormalTok{dataFR }\OtherTok{\textless{}{-}} \FunctionTok{readRDS}\NormalTok{(}\StringTok{"data/data\_FR.RDS"}\NormalTok{)}
\NormalTok{dataFR }\OtherTok{\textless{}{-}} \FunctionTok{na.omit}\NormalTok{(dataFR[,}\FunctionTok{c}\NormalTok{(}\StringTok{"EURIBOR\_3M"}\NormalTok{,}\StringTok{"dlGDP"}\NormalTok{,}
                            \StringTok{"U"}\NormalTok{, }\StringTok{"HICP"}\NormalTok{, }\StringTok{"underinf"}\NormalTok{)])}
\NormalTok{dataFR }\OtherTok{\textless{}{-}} \FunctionTok{window}\NormalTok{(dataFR, }\AttributeTok{end =} \FunctionTok{c}\NormalTok{(}\DecValTok{2018}\NormalTok{,}\DecValTok{4}\NormalTok{))}

\FunctionTok{round}\NormalTok{(}\FunctionTok{sapply}\NormalTok{(dataFR, stationnarity\_test), }\DecValTok{3}\NormalTok{)}
\CommentTok{\# Au seuil de 5 \%, orsque l\textquotesingle{}on enlève une tendance linéaire on trouve que}
\CommentTok{\# toutes les séries stationnaires selon kpss et selon ADF sauf pour l\textquotesingle{}inflation}
\CommentTok{\# le test adf est sensible aux points atypiques.}
\CommentTok{\# Dans notre cas, ces séries semblent bien stationnaire}
\CommentTok{\# mais les premières années (avant 2000) semblent légèrement différentes }
\CommentTok{\# du reste, ce qui pourrait impacter le test ADF. Ainsi, on remarque que }
\CommentTok{\# lorsque l\textquotesingle{}on effectue le test après 2000, les séries sont bien stationnaires}
\CommentTok{\# C\textquotesingle{}est pourquoi on effectue un VAR avec un modèle contenant constante + }
\CommentTok{\# tendance linéaire.}
\FunctionTok{round}\NormalTok{(}\FunctionTok{sapply}\NormalTok{(}\FunctionTok{window}\NormalTok{(dataFR,}\AttributeTok{start =} \DecValTok{2000}\NormalTok{), stationnarity\_test), }\DecValTok{3}\NormalTok{)}


\NormalTok{p }\OtherTok{\textless{}{-}}\NormalTok{ (}\FunctionTok{plot\_ts}\NormalTok{(dataFR, }\StringTok{"EURIBOR\_3M"}\NormalTok{) }\SpecialCharTok{+}
          \FunctionTok{plot\_ts}\NormalTok{(dataFR, }\StringTok{"dlGDP"}\NormalTok{))}\SpecialCharTok{/}\NormalTok{(}
              \FunctionTok{plot\_ts}\NormalTok{(dataFR, }\StringTok{"U"}\NormalTok{) }\SpecialCharTok{+} 
                  \FunctionTok{plot\_ts}\NormalTok{(dataFR, }\StringTok{"HICP"}\NormalTok{) }\SpecialCharTok{+} 
                  \FunctionTok{plot\_ts}\NormalTok{(dataFR, }\StringTok{"underinf"}\NormalTok{)}
\NormalTok{              )}
\NormalTok{(p }\SpecialCharTok{\&} \FunctionTok{theme\_minimal}\NormalTok{() )}\SpecialCharTok{+} 
    \FunctionTok{plot\_annotation}\NormalTok{(}\AttributeTok{title =} \StringTok{\textquotesingle{}France\textquotesingle{}}\NormalTok{)}

\NormalTok{var\_ordering1 }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"dlGDP"}\NormalTok{,}
                 \StringTok{"U"}\NormalTok{, }\StringTok{"underinf"}\NormalTok{,}\StringTok{"HICP"}\NormalTok{, }\StringTok{"EURIBOR\_3M"}\NormalTok{)}
\NormalTok{var\_ordering2 }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"EURIBOR\_3M"}\NormalTok{, }\StringTok{"dlGDP"}\NormalTok{,}
                 \StringTok{"U"}\NormalTok{, }\StringTok{"underinf"}\NormalTok{,}\StringTok{"HICP"}\NormalTok{)}

\CommentTok{\#Select AIC{-}suggested lag}
\NormalTok{lagselect }\OtherTok{\textless{}{-}}\FunctionTok{VARselect}\NormalTok{(dataFR[,var\_ordering1],}
                      \AttributeTok{lag.max=}\DecValTok{6}\NormalTok{,}\AttributeTok{type=}\StringTok{"const"}\NormalTok{)}
\CommentTok{\# Le critère du BIC indique 1 lag}
\NormalTok{lagselect}
\NormalTok{p\_retenu }\OtherTok{=} \DecValTok{1}

\CommentTok{\# L\textquotesingle{}ordre des variables n\textquotesingle{}aura pas d\textquotesingle{}impact sur les analyses du VAR}
\CommentTok{\# mais uniquement dans la spécification du sVAR}
\NormalTok{model }\OtherTok{\textless{}{-}} \FunctionTok{VAR}\NormalTok{(dataFR[,var\_ordering1],}
           \AttributeTok{p =}\NormalTok{ p\_retenu,}\AttributeTok{type =} \StringTok{"both"}\NormalTok{)}
\NormalTok{model2 }\OtherTok{\textless{}{-}} \FunctionTok{VAR}\NormalTok{(dataFR[,var\_ordering2],}
             \AttributeTok{p =}\NormalTok{ p\_retenu,}\AttributeTok{type =} \StringTok{"both"}\NormalTok{)}
\CommentTok{\# Pas d\textquotesingle{}autocorrélation dans les résidus}
\FunctionTok{serial.test}\NormalTok{(model)}

\CommentTok{\# Pas d\textquotesingle{}hétéroscédasticité dans les résidus}
\FunctionTok{arch.test}\NormalTok{(model)}
\CommentTok{\# Ni de problème de stabilité dans les coefficients}
\FunctionTok{plot}\NormalTok{(}\FunctionTok{stability}\NormalTok{(model))}

\CommentTok{\# Pour récupérer le code latex du VAR :}
\FunctionTok{cat}\NormalTok{(}\FunctionTok{latexify\_var}\NormalTok{(model,}\AttributeTok{align =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{nb\_dec =} \DecValTok{2}\NormalTok{, }\AttributeTok{se =} \ConstantTok{TRUE}\NormalTok{))}
\FunctionTok{cat}\NormalTok{(}\FunctionTok{latexify\_mat}\NormalTok{(}\FunctionTok{cor}\NormalTok{(}\FunctionTok{residuals}\NormalTok{(model)), }\AttributeTok{nb\_dec =} \DecValTok{2}\NormalTok{))}


\NormalTok{Bmat\_chol }\OtherTok{\textless{}{-}} \FunctionTok{diag}\NormalTok{(}\AttributeTok{nrow =} \DecValTok{5}\NormalTok{)}
\NormalTok{Bmat\_chol[}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ Bmat\_chol[}\DecValTok{3}\NormalTok{,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{] }\OtherTok{\textless{}{-}} 
\NormalTok{    Bmat\_chol[}\DecValTok{4}\NormalTok{,(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{)] }\OtherTok{\textless{}{-}}\NormalTok{ Bmat\_chol[}\DecValTok{5}\NormalTok{,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{] }\OtherTok{\textless{}{-}} 
    \FunctionTok{diag}\NormalTok{(Bmat\_chol) }\OtherTok{\textless{}{-}} \ConstantTok{NA}
\NormalTok{Bmat\_chol }\CommentTok{\# Choleski}

\NormalTok{Bmat }\OtherTok{\textless{}{-}} \FunctionTok{diag}\NormalTok{(}\AttributeTok{nrow =} \DecValTok{5}\NormalTok{)}
\NormalTok{Bmat[}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ Bmat[}\DecValTok{3}\NormalTok{,}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{)] }\OtherTok{\textless{}{-}} 
\NormalTok{    Bmat[}\DecValTok{4}\NormalTok{,}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{)] }\OtherTok{\textless{}{-}}\NormalTok{ Bmat[}\DecValTok{5}\NormalTok{,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{] }\OtherTok{\textless{}{-}} 
    \FunctionTok{diag}\NormalTok{(Bmat) }\OtherTok{\textless{}{-}} \ConstantTok{NA}
\NormalTok{Bmat }\CommentTok{\# affiné}

\NormalTok{Bmat2 }\OtherTok{\textless{}{-}} \FunctionTok{diag}\NormalTok{(}\AttributeTok{nrow =} \DecValTok{5}\NormalTok{)}
\NormalTok{Bmat2[}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{] }\OtherTok{\textless{}{-}}\NormalTok{ Bmat2[}\DecValTok{3}\NormalTok{,}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{)] }\OtherTok{\textless{}{-}} 
\NormalTok{    Bmat2[}\DecValTok{5}\NormalTok{,}\DecValTok{4}\NormalTok{] }\OtherTok{\textless{}{-}} 
    \FunctionTok{diag}\NormalTok{(Bmat2) }\OtherTok{\textless{}{-}} \ConstantTok{NA}
\NormalTok{Bmat2 }\CommentTok{\# affiné}

\NormalTok{smodel1\_chol }\OtherTok{\textless{}{-}} \FunctionTok{SVAR}\NormalTok{(model,}\AttributeTok{Bmat =}\NormalTok{ Bmat\_chol)}
\NormalTok{smodel1 }\OtherTok{\textless{}{-}} \FunctionTok{SVAR}\NormalTok{(model,}\AttributeTok{Bmat =}\NormalTok{ Bmat) }
\NormalTok{smodel1\_chol}\SpecialCharTok{$}\NormalTok{B }\CommentTok{\# coefficients imposés à 0 proches de 0}
\FunctionTok{cat}\NormalTok{(}\FunctionTok{latexify\_mat}\NormalTok{(smodel1}\SpecialCharTok{$}\NormalTok{B, }\AttributeTok{nb\_dec =} \DecValTok{3}\NormalTok{))}

\NormalTok{smodel2 }\OtherTok{\textless{}{-}} \FunctionTok{SVAR}\NormalTok{(model2,}\AttributeTok{Bmat =}\NormalTok{ Bmat\_chol)}
\NormalTok{smodel2 }\OtherTok{\textless{}{-}} \FunctionTok{SVAR}\NormalTok{(model2,}\AttributeTok{Bmat =}\NormalTok{ Bmat\_chol)}
\NormalTok{smodel2}
\CommentTok{\# les coefficients que l\textquotesingle{}on va imposer à 0 sont estimés à 0}
\CommentTok{\# en utilisant la décomposition de choleski}
\CommentTok{\# Les mêmes résultats sont donc trouvés entre les deux méthodes}
\NormalTok{smodel2 }\OtherTok{\textless{}{-}} \FunctionTok{SVAR}\NormalTok{(model2,}\AttributeTok{Bmat =}\NormalTok{ Bmat2)}
\NormalTok{smodel2}
\FunctionTok{cat}\NormalTok{(}\FunctionTok{latexify\_mat}\NormalTok{(smodel2}\SpecialCharTok{$}\NormalTok{B, }\AttributeTok{nb\_dec =} \DecValTok{3}\NormalTok{))}

\CommentTok{\# Utilisation de Blanchard Quah, non commenté dans le rapport}
\NormalTok{smodel1\_bq }\OtherTok{\textless{}{-}} \FunctionTok{BQ}\NormalTok{(model)}
\NormalTok{smodel2\_bq }\OtherTok{\textless{}{-}} \FunctionTok{BQ}\NormalTok{(model2)}

\NormalTok{irf\_1 }\OtherTok{\textless{}{-}} \FunctionTok{irf}\NormalTok{(smodel1, }\AttributeTok{impulse =} \StringTok{"EURIBOR\_3M"}\NormalTok{,}
           \AttributeTok{n.ahead =} \DecValTok{20}\NormalTok{)}
\NormalTok{irf\_1\_chol }\OtherTok{\textless{}{-}} \FunctionTok{irf}\NormalTok{(smodel1\_chol, }\AttributeTok{impulse =} \StringTok{"EURIBOR\_3M"}\NormalTok{,}
             \AttributeTok{n.ahead =} \DecValTok{20}\NormalTok{)}
\NormalTok{irf\_1\_bq }\OtherTok{\textless{}{-}} \FunctionTok{irf}\NormalTok{(smodel1\_bq, }\AttributeTok{impulse =} \StringTok{"EURIBOR\_3M"}\NormalTok{,}
                  \AttributeTok{n.ahead =} \DecValTok{20}\NormalTok{)}

\NormalTok{irf\_2 }\OtherTok{\textless{}{-}} \FunctionTok{irf}\NormalTok{(smodel2, }\AttributeTok{impulse =} \StringTok{"EURIBOR\_3M"}\NormalTok{,}
             \AttributeTok{n.ahead =} \DecValTok{20}\NormalTok{)}
\NormalTok{irf\_2\_bq }\OtherTok{\textless{}{-}} \FunctionTok{irf}\NormalTok{(smodel2\_bq, }\AttributeTok{impulse =} \StringTok{"EURIBOR\_3M"}\NormalTok{,}
                \AttributeTok{n.ahead =} \DecValTok{20}\NormalTok{)}

\FunctionTok{plot\_irf}\NormalTok{(irf\_1\_chol) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Choleski {-} GDP{-}led"}\NormalTok{) }
\CommentTok{\# Quasiment même résultat comme attendu :}
\FunctionTok{plot\_irf}\NormalTok{(irf\_1) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Matrice affinée {-} GDP{-}led"}\NormalTok{) }

\CommentTok{\# Non commenté dans le rapport}
\FunctionTok{plot\_irf}\NormalTok{(irf\_1\_bq) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Blanchard Quah decomposition {-} GDP{-}led"}\NormalTok{) }

\FunctionTok{plot\_irf}\NormalTok{(irf\_2) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Matrice affinée {-} Euribor{-}led"}\NormalTok{)}
\FunctionTok{plot\_irf}\NormalTok{(irf\_2\_bq) }\SpecialCharTok{+} \FunctionTok{ggtitle}\NormalTok{(}\StringTok{"Blanchard Quah decomposition {-} Euribor{-}led"}\NormalTok{)}

\CommentTok{\# decomposition de la variance}
\CommentTok{\# non utilisé dans le rapport}
\NormalTok{fevd }\OtherTok{\textless{}{-}} \FunctionTok{fevd}\NormalTok{(smodel1, }\AttributeTok{n.ahead =} \DecValTok{20}\NormalTok{)}
\FunctionTok{plot\_fevd}\NormalTok{(fevd)}


\FunctionTok{saveRDS}\NormalTok{(model, }\StringTok{"data/models\_FR/var\_model.RDS"}\NormalTok{)}
\FunctionTok{saveRDS}\NormalTok{(irf\_1, }\StringTok{"data/models\_FR/irf\_1"}\NormalTok{)}
\FunctionTok{saveRDS}\NormalTok{(irf\_1\_chol, }\StringTok{"data/models\_FR/irf\_1\_chol"}\NormalTok{)}
\FunctionTok{saveRDS}\NormalTok{(irf\_1\_bq, }\StringTok{"data/models\_FR/irf\_1\_bq"}\NormalTok{)}
\FunctionTok{saveRDS}\NormalTok{(irf\_2, }\StringTok{"data/models\_FR/irf\_2"}\NormalTok{)}
\FunctionTok{saveRDS}\NormalTok{(irf\_2\_bq, }\StringTok{"data/models\_FR/irf\_2\_bq"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}


\end{document}
