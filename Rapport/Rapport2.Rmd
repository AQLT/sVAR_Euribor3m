---
title: |
    |  ![](img/LOGO-ENSAE.png){height=2.5cm} 
    |  \textsc{Applied macroeconometrics}
    |  Les effets d’une hausse de l’Euribor 3-mois
author: |
    | Valentin Giust, Gautier Lenfant et Alain Quartier-la-Tente
automaticcontents: true
output:
  bookdown::pdf_document2:
        toc: true
        number_sections: true
        fig_width: 7
        fig_height: 6
        fig_caption: true
        highlight: default
        keep_tex: yes
        includes:
          in_header: preamble.tex
        logo: ""
fontsize: 10pt
geometry: margin=0.80in
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                        fig.path = "img/markdown-",
                      cache = FALSE)
source("../R/Z - Fonctions.R", encoding = "UTF-8",
       local = knitr::knit_global())
dataUE <- readRDS("../data/data_UE.RDS")
dataUE <- na.omit(dataUE[,c("EURIBOR_3M", "lGDP","dlGDP",
                            "U", "HICP", "underinf")])
dataUE <- window(dataUE, end = c(2018,4))
dataFR <- readRDS("../data/data_FR.RDS")
dataFR <- na.omit(dataFR[,c("EURIBOR_3M", "lGDP","dlGDP",
                            "U", "HICP", "underinf")])
dataFR <- window(dataFR, end = c(2018,4))
```

\vfill

The source code and this repport is also available at https://github.com/AQLT/AppliedMacroEuribor.

\newpage

# Introduction {-}

In this essay, we build on a VAR model to quantify the effects of variations in the Euribor-3M (benchmark short term market rate in Europe) rate on a series of key macroeconomic variables (GDP, inflation, unemployment, investment) both at the Euro Area (EA) level, and in the particular case of France. We map out different scenarios of rise and falls in the Euribor-3M to assess the response of the economy to monetary shocks of different kinds and amplitudes. Our model predicts that a one standard-deviation rise in the Euribor-3M rate is associated with a significant and lingering drift of the EA GDP down its no-shock trend. Further, we find evidence that a rise in the short term monetary rate brings conventional inflation below its no-shock trend for a substantial period of time. We also find that a rising Euribor-3M rate has a detrimental effect on both the EA and the French labor markets. PARLER DES SCENARII

When it comes to the relationship between the short-term rate and the main macroeconomic variables, our VAR-based findings are consistent with the theoretical predictions of the Neo-keynesian framework : a tightening of monetary policy has a negative impact on aggregate demand, which deteriorates employment and brings down inflation in a significant fashion. 

In the first part, we present our data set and provide the origin of our empirical resources. We then present our empirical strategy and the features of our specification in the second part. Finally, the last part exhibits the results of our estimations. 

# Data setting {-}

## Data origin and features {-}

ORIGIN

We extensively rely on macroeconomic data provided by official statistical offices... We choose a time frame spanning 1997-2018. Why this time span ? 

GDP : real, SA, EURO2005? à vérifier
FBCE : real, SA
Our data on unemployment originates from the Eurostat Database

FEATURES & STATIONARITY 

Before implementing the VAR model, we make sure that our variables feature stationarity. Why ? We thus detrend consumption, unemployment ... The following KPSS tests provides strong evidence for the stationarity of our macroeconomic variables. 

Graphs

## A few stylized facts {-}
 
In this subsection, we exhibit a few stylized facts characterizing the macroeconomic trends in the EA between 1997 and 2018. Likewise, we give similar facts in the particular case of France. 

ALL GRAPHS BOUND TOGETHER DANS UN FRAME ENTRE 1997 et 2018

Graphs short term rate

Graphs variables of aggregate demand : FBCF, Consumption, GDP 
consistent with the theory, FBCF varies more than consumption?

Graphs unemployment

Graphs price variables

Comment :

Upon careful observation of the above graphs, it is clear that the macroeconomic history of the EA splits out in two periods, respectively spanning 1997-2008, and 2008-2018. The 2008 financial crisis is a watershed marking the start of a period of weaker macroeconomic performance, whether it be for France or the EA as a whole. It is worth noting that the macroeconomic situation is particularly depressed between 2012 and 2015 amid the austerity policies which were implemented in the wake of the sovereign debt crisis. How is France wrt. EA? France performs worse that the EA ! Parler justement de ce qu'on observe entre les taux et les macro variables. A noteworthy observation is that the EA economy fell deeper in the wake of the 2011 policy rate rise, which translated into a rise in the Euribor rate. 

```{r plot-data-ue, echo=FALSE,fig.cap="European Area data plots.", fig.dim=c(7,4)}
p <- (plot_ts(dataUE, "EURIBOR_3M") +
          plot_ts(dataUE, "dlGDP"))/(
              plot_ts(dataUE, "U") + 
                  plot_ts(dataUE, "HICP") + 
                  plot_ts(dataUE, "underinf")
              )
p & theme_minimal()
```

```{r plot-data-fr, echo=FALSE,fig.cap="French data plots.", fig.dim=c(7,4)}
p <- (plot_ts(dataFR, "EURIBOR_3M") +
          plot_ts(dataFR, "dlGDP"))/(
              plot_ts(dataFR, "U") + 
                  plot_ts(dataFR, "HICP") + 
                  plot_ts(dataFR, "underinf")
              )
p & theme_minimal()
```

# Empirical strategy

In this section, we describe and explain the features of our VAR specification. 
In the this report, we will use the following notations:

- $y_t$ for the log of the GDP;
- $U_t$ for the unemployment;
- $\pi_t$ for the inflation (year on year evolution of the HICP);
- $\pi_t^{core}$ for the core inflation (year on year evolution);
- $R_t$ for 3 months EURIBOR rate.

The same specification is used for the European Area and the French dataset:

- We estimate a VAR model with a constant and a linear trend.

- The number of lags of the model is determined by minimizing the Schwarz information criterion: we find that 1 lag is enough to have a well specified model (no serial correlation, stability of the estimates and no ARCH effect).

Equations \@ref(eq:var-ea) and \@ref(eq:var-fr) shows the estimated parameters and the t-sat of the VAR model, respectively for the European Aera and for the French data.

\begin{equation}
\begin{pmatrix}
 \Delta y_{t} \\
U_{t} \\
\pi^{core}_{t} \\
\pi_{t} \\
R_{t} 
\end{pmatrix} = \begin{pmatrix}
 \underset{(0.01)}{0.03} & \underset{(0.00)}{-0.00} \\
\underset{(0.32)}{-0.76} & \underset{(0.00)}{0.00} \\
\underset{(0.00)}{0.00} & \underset{(0.00)}{0.00} \\
\underset{(0.01)}{0.01} & \underset{(0.00)}{-0.00} \\
\underset{(0.56)}{0.51} & \underset{(0.00)}{-0.00} 
\end{pmatrix} \begin{pmatrix} 1 \\ t \end{pmatrix}+\begin{pmatrix}
 \underset{(0.11)}{0.24} & \underset{(3.35)}{-16.20} & \underset{(0.03)}{0.08} & \underset{(0.07)}{0.32} & \underset{(5.84)}{31.29} \\
\underset{(0.00)}{-0.00} & \underset{(0.02)}{1.03} & \underset{(0.00)}{-0.00} & \underset{(0.00)}{-0.00} & \underset{(0.03)}{-0.03} \\
\underset{(0.21)}{-0.48} & \underset{(6.55)}{18.55} & \underset{(0.07)}{0.85} & \underset{(0.14)}{-0.00} & \underset{(11.44)}{-11.01} \\
\underset{(0.09)}{-0.11} & \underset{(2.75)}{4.25} & \underset{(0.03)}{0.04} & \underset{(0.06)}{0.90} & \underset{(4.79)}{10.51} \\
\underset{(0.00)}{-0.00} & \underset{(0.03)}{0.02} & \underset{(0.00)}{0.00} & \underset{(0.00)}{-0.00} & \underset{(0.05)}{0.89} 
\end{pmatrix} \begin{pmatrix}
 \Delta y_{t - 1} \\
U_{t - 1} \\
\pi^{core}_{t - 1} \\
\pi_{t - 1} \\
R_{t - 1} 
\end{pmatrix}+ \varepsilon^{EA}_t
(\#eq:var-ea)
\end{equation}

\begin{equation}
\begin{pmatrix}
 \Delta y_{t} \\
U_{t} \\
\pi^{core}_{t} \\
\pi_{t} \\
R_{t} 
\end{pmatrix} = \begin{pmatrix}
 \underset{(0.01)}{0.02} & \underset{(0.00)}{-0.00} \\
\underset{(0.60)}{0.18} & \underset{(0.00)}{-0.00} \\
\underset{(0.01)}{0.02} & \underset{(0.00)}{0.00} \\
\underset{(0.01)}{0.02} & \underset{(0.00)}{0.00} \\
\underset{(0.88)}{0.91} & \underset{(0.00)}{-0.00} 
\end{pmatrix} \begin{pmatrix} 1 \\ t \end{pmatrix}+\begin{pmatrix}
 \underset{(0.10)}{0.32} & \underset{(5.42)}{-27.97} & \underset{(0.05)}{0.06} & \underset{(0.11)}{0.53} & \underset{(7.91)}{45.45} \\
\underset{(0.00)}{-0.00} & \underset{(0.05)}{1.01} & \underset{(0.00)}{-0.00} & \underset{(0.00)}{-0.00} & \underset{(0.07)}{-0.10} \\
\underset{(0.13)}{-0.24} & \underset{(7.41)}{5.34} & \underset{(0.07)}{0.74} & \underset{(0.15)}{0.18} & \underset{(10.81)}{-14.48} \\
\underset{(0.06)}{-0.04} & \underset{(3.23)}{4.24} & \underset{(0.03)}{-0.06} & \underset{(0.06)}{0.75} & \underset{(4.72)}{3.97} \\
\underset{(0.00)}{-0.00} & \underset{(0.03)}{-0.05} & \underset{(0.00)}{0.00} & \underset{(0.00)}{-0.00} & \underset{(0.05)}{0.94} 
\end{pmatrix} \begin{pmatrix}
 \Delta y_{t - 1} \\
U_{t - 1} \\
\pi^{core}_{t - 1} \\
\pi_{t - 1} \\
R_{t - 1} 
\end{pmatrix}+ \varepsilon^{FR}_t
(\#eq:var-fr)
\end{equation}

Equation \@ref(eq:variances) shows the estimates of the covariance matrix of the residuals. 
We can notice that those matrices are not diagonal: this means that a shock on a component is correlated to a shock on the other components. 
It implies that we cannot directly estimate the impact of a shock on the 3 months Euribor rates, $R_t$.
To do so, we need to make some assumptions on the propagation of the shocks that are described in section \@ref(sec:est).

\begin{equation}
\mathbb{V}\varepsilon^{EA}_t = 
\begin{pmatrix}
 1.00 & -0.61 & -0.21 & 0.06 & 0.41 \\
-0.61 & 1.00 & 0.07 & 0.02 & -0.41 \\
-0.21 & 0.07 & 1.00 & 0.20 & -0.06 \\
0.06 & 0.02 & 0.20 & 1.00 & 0.25 \\
0.41 & -0.41 & -0.06 & 0.25 & 1.00 
\end{pmatrix}
\quad
\mathbb{V}\varepsilon^{FR}_t = 
\begin{pmatrix}
 1.00 & -0.44 & -0.06 & 0.24 & 0.48 \\
-0.44 & 1.00 & -0.06 & -0.23 & -0.40 \\
-0.06 & -0.06 & 1.00 & 0.13 & 0.00 \\
0.24 & -0.23 & 0.13 & 1.00 & 0.31 \\
0.48 & -0.40 & 0.00 & 0.31 & 1.00 
\end{pmatrix}
(\#eq:variances)
\end{equation}

# Estimations of a shock on the 3 months Euribor rate {#sec:est}

In this section, we depict the results of the our estimation endeavor.

## A demand oriented set of scenarios

In the first scenario, demand oriented, we suppose that Euribor is the primary force at play. GDP reacts contemporaneously to Euribor and impacts all the other variables. Unemployment follows contemporaneously. Both inflation and core inflation follow with delay.

Statistically speaking, this scenario is equivalent to reorder the variables in the order 
$\begin{pmatrix}  R_{t} &\Delta y_{t} & U_{t} &\pi^{core}_{t} &\pi_{t} \end{pmatrix}$ and to estimate a matrix $B_1$, such has $\mathbb V\varepsilon_t=B_1B_1'$ and with the following constraints:
$$ B_1\sim\begin{pmatrix}1 & 0 & 0 & 0 & 0\\
* & 1 & 0 & 0 & 0\\
* & * & 1 & 0 & 0\\
0 & 0 & 0 & 1 & 0\\
0 & 0 & 0 & * & 1
\end{pmatrix}$$
Using the data, we found the following $B$ matrices^[
Note that not imposing any coefficient in the lower triangular matrix $B_1$ to be null (and so to compute a Choleski decomposition) would not change the results. Indeed, in that case the estimates of the associated coefficients are closed to zero.
]:
$$B_1^{EA} =\begin{pmatrix}
 0.288 & 0.000 & 0.000 & 0.000 & 0.000 \\
0.002 & 0.005 & 0.000 & 0.000 & 0.000 \\
-0.068 & -0.080 & 0.128 & 0.000 & 0.000 \\
0.000 & 0.000 & 0.000 & 0.002 & 0.000 \\
0.000 & 0.000 & 0.000 & 0.001 & 0.003 
\end{pmatrix}
\quad
B_1^{FR}=\begin{pmatrix}
 0.284 & 0.000 & 0.000 & 0.000 & 0.000 \\
0.002 & 0.003 & 0.000 & 0.000 & 0.000 \\
-0.078 & -0.054 & 0.170 & 0.000 & 0.000 \\
0.000 & 0.000 & 0.000 & 0.002 & 0.000 \\
0.000 & 0.000 & 0.000 & 0.001 & 0.004 
\end{pmatrix}$$


## A supply oriented set of scenarios

In the second scenario, supply oriented, we will suppose that GDP is the primary force at play: a shock in the GDP contemporaneously affects all the variables. Then unemployment follows contemporaneously but a shock on the unemployment only affects inflation and core inflation with delay. Finally, the Euribor is contemporaneously affected by a shock on the other variables but the opposite is not true (a shock in the Euribor will only affect with delay the other components).

Statistically speaking, this scenario is equivalent to use the same order of the variables than in equations \@ref(eq:var-ea) and \@ref(eq:var-fr)and to estimate a matrix $B_2$, such has $\mathbb V\varepsilon_t=B_2B_2'$ and with the following constraints:
$$ B_2\sim\begin{pmatrix}1 & 0 & 0 & 0 & 0\\
* & 1 & 0 & 0 & 0\\
* & 0 & 1 & 0 & 0\\
* & 0 & * & 1 & 0\\
* & * & * & * & 1
\end{pmatrix}$$
Using the data, we found the following $B$ matrices^[
Note that, as in the previous section, not imposing any coefficient in the lower triangular matrix $B_2$ to be null (and so to compute a Choleski decomposition) would not change the results. Indeed, in that case the estimates of the associated coefficients are closed to zero.
]:
$$B_2^{EA} =\begin{pmatrix}
 0.005 & 0.000 & 0.000 & 0.000 & 0.000 \\
-0.101 & 0.131 & 0.000 & 0.000 & 0.000 \\
-0.000 & 0.000 & 0.002 & 0.000 & 0.000 \\
0.000 & 0.000 & 0.001 & 0.003 & 0.000 \\
0.119 & -0.064 & 0.002 & 0.072 & 0.246 
\end{pmatrix}
\quad
B_2^{FR}=\begin{pmatrix}
 0.003 & 0.000 & 0.000 & 0.000 & 0.000 \\
-0.085 & 0.175 & 0.000 & 0.000 & 0.000 \\
-0.000 & 0.000 & 0.002 & 0.000 & 0.000 \\
0.001 & 0.000 & 0.001 & 0.004 & 0.000 \\
0.135 & -0.054 & 0.004 & 0.051 & 0.237 
\end{pmatrix}$$

## Impulse response functions

In the demand scenario, upon careful examination of the IRFs (figures \@ref(fig:plot-irf-ea-demand) and \@ref(fig:plot-irf-fr-demand)), we notice that a unitary shock in the Euribor has a significant effect contemporaneous effect in GDP (positively) and in the unemployment (negatively).
It implies a backlash in the GDP that decreases in the first year and then slowly returns to normal.
This mechanism involves a decrease in the unemployment in the first quarters and then returns to normal, and an increase in the core inflation and in the inflation  during the first year. The impact is higher in the core inflation than in the inflation, the first being more sensitive to the changes in GDP and in unemployment. The Euribor continues to increase in the first quarter after the shock, then begin to decreases and returns to normal after 3 years.
The same evolutions are observes for the French economy and for the European Area. However, in the European Area economy, we observe a lower impact of the shock and a faster return to normal.


```{r plot-irf-ea-demand, echo=FALSE,fig.cap="Responses functions on the European Aera economy of a shock on the 3 months Euribor rates, $R_t$ with a 95% bootstrap confidence interval in the demand scenario.", fig.dim=c(7,4)}
irf = readRDS("../data/models_EA/irf_2")
plot_irf(irf)
```

```{r plot-irf-fr-demand, echo=FALSE,fig.cap="Responses functions on the French economy of a shock on the 3 months Euribor rates, $R_t$ with a 95% bootstrap confidence interval in the demand scenario.", fig.dim=c(7,4)}
irf = readRDS("../data/models_FR/irf_2")
plot_irf(irf)
```


In the supply scenario, upon careful examination of the IRFs (figures \@ref(fig:plot-irf-ea-supply) and \@ref(fig:plot-irf-fr-supply)), we notice that a unitary shock in the Euribor has no significant effect on the unemployment and the core inflation.
However, this shocks involves a decrease in the GDP that returns to normal after almost 3 years.
Unlike what we observe in the demand scenario, the inflation decreases in the first year and then returns to normal.
The Euribor slowly returns to normal.
The same evolutions are observes for the French economy and for the European Area.


```{r plot-irf-ea-supply, echo=FALSE,fig.cap="Responses functions on the European Aera economy of a shock on the 3 months Euribor rates, $R_t$ with a 95% bootstrap confidence interval in the supply scenario.", fig.dim=c(7,4)}
irf = readRDS("../data/models_EA/irf_1")
plot_irf(irf)
```


```{r plot-irf-fr-supply, echo=FALSE,fig.cap="Responses functions on the French economy of a shock on the 3 months Euribor rates, $R_t$ with a 95% bootstrap confidence interval in the supply scenario.", fig.dim=c(7,4)}
irf = readRDS("../data/models_FR/irf_1")
plot_irf(irf)
```

The above observations provide evidence that our findings are consistent with some key theoretical predictions of the Neo Keynesian model: 


\newpage

J'ai rajouté les gaphiques Blanchard Quah au cas où mais je pense que ce n'est pas la peine de les mettre.


```{r plot-irf-ea-demand-bq, echo=FALSE,fig.cap="Responses functions on the European Aera economy of a shock on the 3 months Euribor rates, $R_t$ with a 95% bootstrap confidence interval in the demand scenario (Blanchard Quah).", fig.dim=c(7,4)}
irf = readRDS("../data/models_EA/irf_2_bq")
plot_irf(irf)
```

```{r plot-irf-fr-demand-bq, echo=FALSE,fig.cap="Responses functions on the French economy of a shock on the 3 months Euribor rates, $R_t$ with a 95% bootstrap confidence interval in the demand scenario (Blanchard Quah).", fig.dim=c(7,4)}
irf = readRDS("../data/models_FR/irf_2_bq")
plot_irf(irf)
```


```{r plot-irf-ea-supply-bq, echo=FALSE,fig.cap="Responses functions on the European Aera economy of a shock on the 3 months Euribor rates, $R_t$ with a 95% bootstrap confidence interval in the supply scenario (Blanchard Quah).", fig.dim=c(7,4)}
irf = readRDS("../data/models_EA/irf_1_bq")
plot_irf(irf)
```


```{r plot-irf-fr-supply-bq, echo=FALSE,fig.cap="Responses functions on the French economy of a shock on the 3 months Euribor rates, $R_t$ with a 95% bootstrap confidence interval in the supply scenario (Blanchard Quah).", fig.dim=c(7,4)}
irf = readRDS("../data/models_FR/irf_1_bq")
plot_irf(irf)
```

\newpage

\appendix

# Code
## Functions
`Z - Fonctions.R` file.

```{r, code = readLines("../R/Z - Fonctions.R"), eval = FALSE, echo=TRUE}
```

## Downloading  of the data
`1-extraction_donnees.R` file.

```{r, code = readLines("../R/1-extraction_donnees.R"), eval = FALSE, echo=TRUE}
```

## Estimation of the models
### European area
`2.1-estimation_modeles EA.R` file.

```{r, code = readLines("../R/2.1-estimation_modeles EA.R"), eval = FALSE, echo=TRUE}
```

### France
`2.2-estimation_modeles FR.R` file.

```{r, code = readLines("../R/2.2-estimation_modeles FR.R"), eval = FALSE, echo=TRUE}
```

